var app = angular.module("app", ["ngRoute", "ngAnimate", "ngSanitize", "ngCookies", "ngMessages", "ui-notification", "ui.mask", "ui.bootstrap", "routes", "bd.sockjs", "cfp.hotkeys", "angucomplete-alt", "timing", "ng.shims.placeholder", "page.visibility", "ngDialog", "angular.bindonce", "http.tracking", "templates-desktop"]);
angular.element(document).ready(function () {
    angular.bootstrap().invoke(["$http", function (a) {
        function b(a) {
            a.user && (App.user = a.user), angular.bootstrap(document, ["app"])
        }

        a.get("/api/user").success(b).error(b)
    }])
}), app.config(["$provide", function (a) {
    App.context.debug || a.decorator("$exceptionHandler", ["$delegate", "$window", function (a) {
        return function (b, c) {
            _errs && _errs.push(b), a(b, c)
        }
    }])
}]), app.config(["$httpProvider", "$provide", function (a, b) {
    b.factory("httpInterceptor", ["$q", "$rootScope", function (a, b) {
        return {
            request: function (c) {
                return c.url.indexOf("views") >= 0 && !b.context.debug && (c.url = b.context.static_host + c.url + "?" + b.context.views_hash), c || a.when(c)
            }
        }
    }]), a.interceptors.push("httpInterceptor")
}]), app.run(["$rootScope", "gaTracker", function (a) {
    a.context = App.context, a.user = App.user
}]), app.run(["$rootScope", "User", "$location", "$cookieStore", function (a, b, c, d) {
    var e = c.search().partner, f = d.get("partner");
    e && a.user && !f && (b.pixel(a.user), d.put("partner", !0))
}]), app.run(["$rootScope", "User", function (a, b) {
    a.user && a.user.pixel && (angular.element(document).find("body").append(a.user.pixel), setTimeout(function () {
        b.pixel(a.user)
    }, 0))
}]), app.run(["$rootScope", function (a) {
    var b = a.context, c = function (a) {
        var b = a.lastIndexOf("/");
        return b > a.indexOf("/") + 1 ? a.substr(0, b) : a
    }, d = c(window.location.href);
    b.debug ? hello.init({
        facebook: b.fb_app_id,
        windows: b.debug ? "000000004412B233" : b.hotmail_app_id || "",
        google: b.debug ? "599718475361-7jd0hmg8vr2pgv10outqssuk0vudpf39.apps.googleusercontent.com" : b.google_app_id || ""
    }, {scope: "photos,email,birthday", redirect_uri: d}) : hello.init({
        windows: b.hotmail_app_id || "",
        google: b.google_app_id || "",
        facebook: b.fb_app_id || ""
    }, {scope: "photos,email,birthday", redirect_uri: d})
}]), app.run(["Timing", "$timeout", "gaTracker", "$rootScope", function (a, b, c, d) {
    d.context && !d.context.debug && b(function () {
        var b = a.getTimes();
        if (b) {
            var e = Math.round(+a.convertToSecond(b.loadTime));
            e = 1 >= e ? "<1s" : e > 1 && 2 >= e ? "1-2s" : e > 2 && 3 >= e ? "2-3s" : e > 3 && 4 >= e ? "3-4s" : e > 4 && 5 >= e ? "4-5s" : e > 5 && 6 >= e ? "5-6s" : "6s+", c.track("load speed", "All", e), d.user && d.user.geo && d.user.geo.code && c.track("load speed", d.user.geo.code, e)
        }
    }, 1e4, !1)
}]), app.controller("AppCtrl", ["$scope", "$location", "User", "$animate", "sockjs", "Messages", "Notifications", "favicoService", function (a, b, c, d, e, f, g, h) {
    a.$on("$viewContentLoaded", function () {
        "undefined" != typeof ga && ga("send", "pageview", {page: b.path()})
    });
    var i = !0;
    a.$on("$locationChangeSuccess", function () {
        window.googletag && window.adseseRight && !i && googletag.cmd.push(function () {
            googletag.pubads().refresh([window.adseseRight])
        }), window.googletag && window.adseseTop && !i && googletag.cmd.push(function () {
            googletag.pubads().refresh([window.adseseTop])
        }), i = !1
    }), a.logout = function () {
        c.logout(function (a) {
            a.error || (window.location.href = "/")
        }, function (a) {
        })
    }, a.messagesPage = !0, a.$watch(function () {
        return b.path()
    }, function (b) {
        b.indexOf("messages") >= 0 ? (d.enabled(!0), a.messagesPage = !1) : (d.enabled(!1), a.messagesPage = !0)
    }), a.unreadMessages = 0, e.messages(function (b) {
        function c(b) {
            f.addMessage(b.s, b), f.updateContacts(b.s), a.$broadcast("scrollToBottom")
        }

        function d() {
            f.conversations[b.s] ? c(b) : f.addUser(b.s, function () {
                c(b)
            })
        }

        b && b.s && (f.get(d, function (a) {
        }), g.add(b, a))
    }), a.$watch(function () {
        return f.unread
    }, function (b) {
        b && (a.unreadMessages = 0, angular.forEach(f.unread, function (b) {
            a.unreadMessages += b
        }), h.badge(a.unreadMessages))
    }, !0)
}]), app.controller("ContactsCtrl", ["$scope", "Messages", "toArrayFilter", function (a, b, c) {
    b.get(function () {
        a.contacts = c(b.conversations)
    }), a.$watch("contactsLength()", function () {
        a.contacts = c(b.conversations)
    }), a.contactsLength = function () {
        return Object.keys(b.conversations).length
    }, a.remove = function (d) {
        b.remove(d, function () {
            angular.forEach(b.conversations, function (a) {
                +a.user_id === +d && delete b.conversations[d]
            }), a.contacts = c(b.conversations)
        })
    }, a.photo = function (a) {
        return angular.isObject(a) ? a.s : a
    }
}]), app.controller("LoginCtrl", ["$scope", "$rootScope", "$location", "User", "ngDialog", "$routeParams", function (a, b, c, d, e, f) {
    a.$parent.loginPage = !0, a.loginForm = !0, a.forgotContent = !0, a.$on("$locationChangeStart", function () {
        a.$parent.loginPage = !1
    }), a.register = function () {
        if (a.form.form_reg.$valid) {
            var b = {email: a.email, password: a.password, gender: a.gender};
            d.register(b, function () {
                c.path("/stream")
            }, function () {
                a.form.form_reg.register_error = !0
            })
        }
        a.form.form_reg.$submitted = !0
    }, a.login = function () {
        a.form.form_auth.$valid && d.login({email: a.email_login, password: a.password_login}, function (a) {
            b.user = a, c.path("/stream")
        }, function () {
            a.form.form_auth.error_login = !0
        }), a.form.form_auth.$submitted = !0
    }, a.forgotDialog = function () {
        a.forgotContent = !0, a.forgotResult = !1, e.open({template: "/views/modals/forgot.password.html", scope: a})
    }, a.showMark = function (a) {
        a.$valid && a.$viewValue && a.$viewValue.length && (a.mark = !0)
    }, a.hideMark = function (a) {
        a.mark = !1
    }, a.forgot = function (b) {
        a.form.form_forgot.$valid && (a.forgotContent = !1, d.forgot({email: b.$viewValue}, function (b) {
            b && (b.message || b.error_msg) && (a.forgotResult = b.message || b.error_msg)
        }, function (a) {
        })), a.form.form_forgot.$submitted = !0
    }, a.resetPassword = function () {
        a.form.reset_password.$valid && d.passwordUpdate({
            password: a.password,
            user_id: f.id,
            hash: f.hash
        }, function (b) {
            b && b.error && b.error_msg ? a.error_message = b.error_msg : b && b.message && (a.reset_success = b.message)
        }, function (a) {
        }), a.form.reset_password.$submitted = !0
    }, a.loginNetwork = function (a) {
        hello.login(a, function (a) {
            var e;
            a.authResponse && (e = a.authResponse.access_token), hello(a.network).api("/me").then(function (f) {
                f.photo = f.picture || f.thumbnail, "google" !== a.network ? f.photo += "?height=1000" : (f.photo = f.photo.substr(0, f.photo.lastIndexOf("?")), f.photo += "?sz=1000"), d.provider({
                    id: f.id,
                    name: f.name,
                    email: f.email,
                    gender: f.gender,
                    photo_url: f.photo,
                    token: e,
                    source: "windows" === a.network ? "hotmail" : a.network,
                    last_mailed: 0,
                    birthday: f.birthday || ""
                }, function (a) {
                    b.user = a, c.path("/stream"), d.pixel(a)
                }, function (a) {
                })
            })
        }, function () {
            window.location.href = window.location.origin + "/?error=access_denied&error_code=200&error_description=Permissions+error&error_reason=user_denied"
        })
    }
}]), app.controller("StreamCtrl", ["$scope", "Rates", "hotkeys", "$routeParams", "$document", "$location", "Visitors", "ngDialog", "Interests", function (a, b, c, d, e, f, g, h, i) {
    function j(b) {
        return 32 !== b.keyCode || "/stream" !== f.path() || a.chatModalShown ? void 0 : !1
    }

    a.stream_user = {}, a.chatModalShown = !1, a.fbModalShown = !1, a.myLikes = b.myLikes, a.count = b.count, a.users = b.users, a.nextDisable = !1;
    var k = d.id || null, l = 0, m = !1, n = function () {
        var b = angular.isArray(a.user.photos) ? a.user.photos.length : 0;
        0 === b && (a.showPopup = !0, a.add_photos = !0, h.open({
            template: "/views/modals/activity.photos.html",
            scope: a,
            preCloseCallback: function () {
                return a.showPopup = !1, m && (a.fbModalShown = !0, m = !m), !0
            }
        }))
    };
    a.uploadFromFb = function () {
        m = !0, h.close()
    }, a.setVisitor = function () {
        a.stream_user && a.stream_user.id && g.set(a.stream_user.id, function (a) {
        }, function (a) {
        })
    }, a.getInterests = function (a) {
        a && a.id && i.getMy(a.id, function (b) {
            a.interests = b.interests
        }, function (a) {
        })
    }, a.getNewUsers = function () {
        b.getUsers(k, function () {
            a.stream_user = b.getUser(b.count), a.getInterests(a.stream_user), a.users = b.users, a.setVisitor(), k = null
        }, function (a) {
        })
    }, a.next = function () {
        var c = b.count, d = b.users[c];
        b.count++, b.users.length && b.getUser(b.count) ? (a.stream_user = b.getUser(b.count), a.getInterests(a.stream_user), a.setVisitor()) : a.getNewUsers(), d && (d.liked = d.liked ? !0 : !1), l++, l % 5 === 0 && n(), setTimeout(function () {
            a.$broadcast("scroll")
        }, 0)
    }, a.next(), a.setRate = function (c) {
        a.stream_user.liked = !0, a.nextDisable || b.set(c, angular.noop, function (a) {
        }), a.next()
    }, a.setUser = function (c, d) {
        d > b.count || (a.stream_user = c, b.count = d, a.$broadcast("scroll"))
    }, a.setMainPhoto = function (b) {
        b && b.sizes && (a.main_photo = b.sizes.o || b.url)
    }, a.$watch("stream_user", function (b) {
        b && b.photos && (a.main_photo = b.photo || b.photos[0].sizes.o)
    }), a.getAge = function (a) {
        if (a) {
            var b = new Date, c = new Date(1e3 * a), d = b.getFullYear() - c.getFullYear(), e = b.getMonth() - c.getMonth();
            return (0 > e || 0 === e && b.getDate() < c.getDate()) && d--, d
        }
    }, a.backgroundImage = function (a) {
        if (a) {
            var b, c = {};
            return b = a.photo, c["background-image"] = "url(" + b + ")", c
        }
    }, e.bind("keypress", j), c.add({
        combo: "space", action: "keyup", callback: function (b) {
            b.preventDefault();
            var c = document.querySelector(".photos .active"), d = a.stream_user.id, e = angular.element(c);
            e.next().length && a.setRate(d)
        }
    }), c.add({
        combo: "right", action: "keyup", callback: function (b) {
            b.preventDefault();
            var c = angular.element(document.querySelector(".photos .active"));
            c.next().length && a.next()
        }
    }), a.$on("$destroy", function () {
        e.off("keypress", j)
    })
}]), app.controller("WorldCtrl", ["$scope", "Rates", "$compile", "$timeout", function (a, b, c, d) {
    var e = angular.element("#stage"), f = e.width(), g = angular.element("#content").height(), h = g / 2 - 60;
    if (d3) {
        var i, j, k, l, m = d3.select("#stage").append("svg:svg").attr("width", f).attr("height", g), n = function () {
            b.users = [], clearTimeout(l), d3.selectAll("svg > *").remove(), i = m.append("svg:defs"), j = m.append("g"), k = m.append("g"), x(), t()
        }, o = function (a, b) {
            i.append("clipPath").attr("id", a.id).append("circle").attr("cy", a.y).attr("cx", a.x).attr("r", a.r), b && b()
        }, p = function (a, b) {
            var c = k.append("image").attr("x", a.x).attr("y", a.y).attr("height", a.h).attr("width", a.w).attr("xlink:href", a.photo).attr("clip-path", "url(#" + a.id + ")");
            b && b(c)
        }, q = function (a) {
            var b = a, c = d3.svg.line().x(function (a) {
                return a.x
            }).y(function (a) {
                return a.y
            }).interpolate("linear"), d = j.append("path").attr("d", c(b));
            return d
        }, r = function () {
            var b = f / 2, c = g / 2;
            o({id: "userPhoto", x: b, y: c, r: 50}, function () {
                p({x: b - 50, y: c - 50, h: 100, w: 100, photo: a.user.photo.p, id: "userPhoto"}, function (a) {
                    a.style("opacity", 0).transition().delay(700).duration(700).style("opacity", 1)
                })
            })
        }, s = function (a, b, c, d, e) {
            var i = Math.random() * (h - h / d) + h / d, j = f / 2 + (i + 30) * Math.cos(2 * Math.PI * b / c), k = g / 2 + (i + 30) * Math.sin(2 * Math.PI * b / c), l = q([{
                x: j,
                y: k
            }, {
                x: f / 2,
                y: g / 2
            }]).attr("stroke", "white").attr("stroke-width", 3).attr("fill", "none"), m = l.node().getTotalLength();
            l.attr("stroke-dasharray", m + " " + m).attr("stroke-dashoffset", m).transition().delay(1e3).duration(700).ease("linear").attr("stroke-dashoffset", 0), o({
                id: a,
                x: j,
                y: k,
                r: 30
            }, function () {
                p({x: j - 35, y: k - 35, w: 70, h: 70, photo: e.photo, id: a}, function (a) {
                    a && (a.style("opacity", 0).style("stroke", "#fff").style("cursor", "pointer").style("stroke-width", "3").transition().delay(700).duration(700).style("opacity", 1), a.on("mouseenter", function (a) {
                        u(a, e, j, k)
                    }).on("mouseout", function (a) {
                        v(a, e)
                    }))
                })
            })
        }, t = function () {
            function a() {
                clearTimeout(l), l = null
            }

            angular.element(".notification").on({mouseenter: a, mousemove: a, mouseleave: v})
        }, u = function (b, c, e, f) {
            function g(a) {
                angular.element("#content").append(a), angular.element(".notification").addClass(c.id), d3.select(".notification").style("display", "block").style("opacity", 0).style("z-index", 2).style("left", h(e, f).x + "px").style("top", h(e, f).y + "px").transition().duration(500).style("opacity", 1)
            }

            function h(a, b) {
                var c = angular.element(".notification").outerHeight(!0), d = angular.element(".notification").outerWidth(!0), e = angular.element(window).width(), f = angular.element(window).height(), g = {
                    x: a,
                    y: b
                };
                return a + d > e && (g.x = a - d), b + c > f && (g.y = b - c), g
            }

            return angular.element(".notification").attr("class").indexOf(c.id) >= 0 ? (clearTimeout(l), void(l = null)) : (a.u = c, clearTimeout(l), l = null, angular.element(".notification").removeClass().addClass("notification"), void d(g, 0))
        }, v = function () {
            function a() {
                d3.select(".notification").transition().duration(500).style("opacity", 0).style("z-index", -1), angular.element(".notification").removeClass().addClass("notification"), l = null
            }

            l || (l = setTimeout(a, 1e3))
        }, w = function () {
            return Math.floor(6 * Math.random() + 1)
        }, x = function () {
            b.getUsers(null, function () {
                var a = b.users, c = 0;
                a.forEach(function (b, d) {
                    setTimeout(function () {
                        s(b.id, d, a.length, w(), b)
                    }, c), c += 500
                }), r()
            }, function (a) {
            })
        };
        n(), angular.element("#refresh").bind("click", n)
    }
}]), app.controller("EmotionsCtrl", ["$scope", "$filter", "Messages", "$timeout", "hotkeys", function (a, b, c, d, e) {
    var f = {
        button: document.querySelector(".emojiButton"),
        messageFiled: document.querySelector("#message-field")
    }, g = function () {
        var b;
        f.messageFiled && (b = f.messageFiled.value, f.messageFiled.focus(), d(function () {
            a.$parent.newMessage = b
        }))
    }, h = function (b) {
        f = {
            button: document.querySelector(".emojiButton"),
            messageFiled: document.querySelector("#message-field")
        }, f.container !== b.target && f.button !== b.target && a.showEmotions && d(function () {
            a.close()
        })
    };
    a.emotions = b("range")([], 0, 47), a.close = function () {
        a.$parent.showEmotions = !1, d(g, 500, !1)
    }, a.addEmotion = function (b, d) {
        var e = '<img class="smile smile-' + d + '"/>', f = a.threadWith;
        f && (c.send(f, e, function () {
            a.$parent.delay = !1, a.$parent.conv || (a.$parent.conv = c.conversations[a.threadWith].conv), a.$parent.$broadcast("scrollToBottom"), a.$parent.newMessage = "", a.close()
        }, function (a) {
        }), b.preventDefault(), b.stopPropagation())
    }, a.$on("$destroy", function () {
        angular.element(document).off("click", h)
    }), e.add({
        combo: "esc", action: "keyup", callback: function () {
            a.close()
        }
    }), angular.element(document).bind("click", h)
}]), app.controller("MessagesCtrl", ["$scope", "$rootScope", "$routeParams", "$timeout", "Messages", "sockjs", "$location", "Rates", "dom", function (a, b, c, d, e, f, g, h, i) {
    function j() {
        setTimeout(function () {
            var a = document.querySelector("#message-field");
            a && a.focus()
        }, 500)
    }

    a.typing = !1, a.load = !1, a.conversations = e.getConversations(), a.threadWith = c.id || null, a.threadInit = function (c) {
        if (e.offset = 0, a.threadWith = a.threadWith || c, a.threadWith) {
            if (b.user && +a.threadWith === +b.user.id)return void g.path("/messages");
            e.threadWith = a.threadWith, e.queueLoad = !1, a.load = !0, e.load(a.threadWith, e.offset, function (b) {
                b && b.thread && e.conversations[a.threadWith] ? (e.conversations[a.threadWith].user.new_message = !1, a.conv = e.conversations[a.threadWith].conv, a.load = !1, a.conversationsArray = Object.keys(e.conversations)) : e.addUser(a.threadWith, function () {
                    a.conv = e.conversations[a.threadWith].conv, a.load = !1, a.conversationsArray = Object.keys(e.conversations)
                }), a.$broadcast("scrollToBottom"), a.$broadcast("initScroll"), j()
            }, function (a) {
            }), e.clearUnread(a.threadWith)
        }
    }, a.addUsers = function () {
        a.conversationsArray = Object.keys(e.conversations), a.conversationsArray.length || (a.users = h.users, a.users.length || h.getUsers(null, function () {
            a.users = h.users
        }))
    }, e.get(function () {
        a.threadInit(), a.addUsers()
    }, function (a) {
    }), a.send = function (b) {
        var c = a.newMessage;
        c && c.length && " " !== c && !a.delay && b && e.conversations[a.threadWith] && (a.delay = !0, e.send(b, c, function () {
            a.delay = !1, a.conv || (a.conv = e.conversations[a.threadWith].conv), a.$broadcast("scrollToBottom"), a.newMessage = ""
        }, function (a) {
        }))
    };
    var k;
    a.writeMessage = function () {
        var c = a.newMessage;
        c && c.length && !k && (k = d(function () {
            d.cancel(k), k = null
        }, 3e3, !1), f.send(JSON.stringify({type: "typing", s: +b.user.id, r: +a.threadWith})))
    }, f.typing(function (b) {
        var c = b.s.toString();
        e.conversations[c] && e.conversations[c].user && (a.threadWith && a.threadWith.toString() === c && (a.typing = !0), e.conversations[c].user.typing = !0, d.cancel(e.conversations[c].user.timer), e.conversations[c].user.timer = d(function () {
            e.conversations[c] && e.conversations[c].user && (e.conversations[c].user.typing = !1, a.typing = !1)
        }, 3500))
    }), a.remove = function (b, c) {
        b.preventDefault(), b.stopPropagation(), e.remove(c, function () {
            angular.forEach(e.conversations, function (a) {
                +a.user_id === +c && delete e.conversations[c]
            }), d(function () {
                var b, c = document.querySelectorAll(".messages .box");
                c = angular.element(c), b = angular.element(i.first(c)), b.length ? g.replace().path(b.attr("href")) : (a.threadWith = null, g.replace().path("/messages"))
            })
        }, function (a) {
        })
    }, a.loadMore = function (b) {
        a.conv && e.loadMore && e.load(a.threadWith, e.offset, function (c) {
            c && c.thread && (a.conv.messages = c.thread.messages.concat(a.conv.messages), e.conversations[a.threadWith].conv = a.conv, b())
        }, function (a) {
        })
    }, a.compare = function (a, b) {
        return +a === +b
    }, a.photo = function (a) {
        return angular.isObject(a) ? a.s : a
    }, a.showEmotions = !1, a.$on("$destroy", function () {
        e.clearConversations()
    })
}]), app.controller("ActivityCtrl", ["$scope", function (a) {
    a.profileEvents = [], a.$parent.$watch("arrayEvents", function (b) {
        a.profileEvents = b
    }), a.search = "", a.contactsLength = function () {
        return a.contacts ? Object.keys(a.contacts).length : 0
    }, a.showModal = function (b) {
        a.$parent.chatModalShown = !0, a.$parent.msgTo = b
    }
}]), app.controller("EditProfileCtrl", ["$rootScope", "$scope", "User", "Geo", "FB", "ngDialog", "Alerts", function (a, b, c, d, e, f, g) {
    b.selectedCountry = {}, b.profile = {}, b.cities = [];
    var h, i, j = function (a) {
        var b = document.createElement("DIV");
        return b.innerHTML = a, b.textContent || b.innerText || ""
    }, k = function (a) {
        return 10 > a && (a = "0" + a), a
    };
    b.$on("createProfile", function () {
        b.profile.gender = b.user_profile.gender, b.profile.name = j(b.user_profile.name), b.user_profile.settings = b.user_profile.settings || {}, a.user.settings = a.user.settings || {}, b.profile.tags = b.user_profile.settings.tags || [], h = b.user_profile.settings, i = h.bg, b.createInfo(), b.dayMonthYear(), b.geo()
    }), b.createInfo = function () {
        b.$parent.profile.aboutMe = b.user_profile.settings.aboutMe, b.$parent.profile.work = b.user_profile.settings.work, b.$parent.profile.education = b.user_profile.settings.education
    }, b.geo = function () {
        b.myProfile && (d.countries(function (a) {
            b.countries = "error" === a.status ? [] : a, b.user_profile.geo && b.user_profile.geo.country_id && b.getCities(b.user_profile.geo.country_id)
        }, function (a) {
        }), d.languages(function (a) {
            b.languages = "error" === a.status ? [] : a
        }, function (a) {
        }))
    }, b.cancel = function () {
        b.$parent.edit = !1
    }, b.getCities = function (a) {
        d.cities(a, function (a) {
            b.cities = "error" === a.status ? [] : a, b.selectedCountry.title && b.user_profile.country !== b.selectedCountry.title && b.$broadcast("angucomplete-alt:clearInput", "cities")
        }, function (a) {
        })
    }, b.$watch("selectedCountry", function (a) {
        if (a && a.originalObject && a.originalObject.id) {
            var c = a.originalObject.id;
            b.getCities(c)
        }
    }), b.changeCountry = function () {
        var a = document.querySelector("#countries_value").value;
        a.length || (b.$broadcast("angucomplete-alt:clearInput", "cities"), b.cities = [])
    }, b.$parent.update = function () {
        var d = document.querySelector("#cities_value").value;
        c.update({
            city_id: b.selectedCity && d.length ? b.selectedCity.originalObject.id : b.user_profile.city_id,
            settings: b.createSettings(),
            gender: b.profile.gender || b.user_profile.gender,
            name: b.testName(b.profile.name) || b.user_profile.name,
            age: b.createAge(b.createSettings().bdate)
        }, function (c) {
            if (c.user) {
                var d = a.user.interests || [];
                b.$parent.user_profile = c.user, b.user_profile.settings = b.user_profile.settings || {}, a.user = c.user, a.user.interests = d, i = b.user_profile.settings.bg, g.add({
                    type: "success",
                    msg: "Well done! You successfully updated your profile."
                })
            }
        }, function (a) {
            g.add({type: "error", msg: "Oops. Something is wrong please try again."})
        })
    }, b.createSettings = function () {
        var a = b.createDate(), c = {};
        return b.user_profile.settings = b.user_profile.settings || {}, c.aboutMe = b.$parent.profile.aboutMe, c.status = b.$parent.profile.status || void 0, c.work = b.$parent.profile.work, c.education = b.$parent.profile.education, c.bdate = a, c.language = b.selectedLanguage ? b.selectedLanguage.originalObject.language : void 0, c.bg = b.user_profile.settings.bg, c
    }, b.testName = function (a) {
        return a ? /\S/.test(a) ? a : void 0 : !1
    }, b.nameBlur = function (a) {
        a || (b.profile.name = b.user_profile.name)
    }, b.$parent.setBg = function (a) {
        b.user_profile.settings || (b.user_profile.settings = {}), b.user_profile.settings.bg = a + ".png"
    }, b.$parent.$watch("editCover", function (a) {
        !a && b.user_profile.settings && b.user_profile.settings.bg && (b.user_profile.settings.bg = i)
    }), b.$parent.$on("$locationChangeStart", function () {
        b.user_profile.settings && (b.user_profile.settings.bg = i)
    }), b.dayMonthYear = function () {
        setTimeout(function () {
            var a = new Date(b.$parent.time);
            angular.isDate(a) && (b.profile.day = k(a.getDate()), b.profile.month = a.getMonth(), b.profile.year = a.getFullYear())
        }, 0)
    }, b.createDate = function () {
        if (b.profile.day && b.profile.month && b.profile.year) {
            var a = +b.profile.day, c = +b.profile.month, d = +b.profile.year, e = new Date(d, c, a), f = e.getFullYear() + "-" + k(e.getMonth() + 1) + "-" + k(e.getDate());
            return f
        }
        return void 0
    }, b.createAge = function (a) {
        if (a) {
            var b = new Date, c = new Date(a), d = b.getFullYear() - c.getFullYear(), e = b.getMonth() - c.getMonth();
            return (0 > e || 0 === e && b.getDate() < c.getDate()) && d--, d
        }
    }, b.updateUser = function () {
        b.$parent.profile.aboutMe = b.form.aboutMe ? b.fb.aboutMe : b.$parent.profile.aboutMe, b.$parent.profile.work = b.form.work ? b.fb.work : b.$parent.profile.work, b.$parent.profile.education = b.form.education ? b.fb.education : b.$parent.profile.education, b.update()
    }, b.$parent.facebookSynchronize = function () {
        e.userInfo(function (a) {
            Object.keys(a).length ? (b.fb = e.synchronizeResult || {}, b.form = {}, f.open({
                scope: b,
                template: "views/modals/confirm.synchronize.html"
            })) : g.add({type: "danger", msg: "Your facebook profile is empty!"})
        })
    }
}]), app.controller("InterestCtrl", ["$scope", "Interests", "$routeParams", "$rootScope", function (a, b, c, d) {
    function e(b) {
        a.userInterests = a.userInterests.concat(b), d.user && (d.user.interests = a.userInterests)
    }

    a.categoryId = "", a.interests = [], a.selectedInterest = {}, a.userInterests = [], a.interestsLimit = 10, a.editInterests = !1;
    var f = +c.id;
    a.$on("$locationChangeStart", function () {
        b.my = []
    }), b.my.length ? e(b.my) : b.getMy(f, function (a) {
        a && a.interests && e(a.interests)
    }, function (a) {
    }), a.getInterests = function (c) {
        a.interests = [], a.categoryId = c, b.getInterests(c, 10, function (b) {
            b && b.interests && (a.interests = b.interests)
        }, function (a) {
        })
    }, b.categories.length ? (a.categories = b.categories, a.getInterests(a.categories[0].id)) : b.get(function () {
        a.categories = b.categories, a.categories.length && a.getInterests(a.categories[0].id)
    }, function (a) {
    }), a.addInterest = function (c) {
        var d = !0;
        a.userInterests.forEach(function (a) {
            return a.id === c.id ? (d = !1, !1) : void 0
        }), d && (a.userInterests.push(c), b.save({tags: [c.id]}, function () {
            a.hideMore && (a.interestsLimit = a.userInterests.length)
        }, function (a) {
        }))
    }, a.removeInterest = function (c, d, e) {
        c.preventDefault(), c.stopPropagation(), a.userInterests.splice(e, 1), b.remove({tags: [d.id]}, function (a) {
        }, function (a) {
        })
    }, a.$watch("selectedInterest", function (b, c) {
        if (!angular.isUndefined(b) && !angular.equals(b, c)) {
            var d = b.originalObject;
            a.addInterest(d)
        }
    })
}]), app.controller("ProfileCtrl", ["$rootScope", "$scope", "$log", "User", "$routeParams", "Visitors", "Likes", "Rates", "Messages", "$timeout", "$filter", "ngDialog", "$q", function (a, b, c, d, e, f, g, h, i, j, k, l, m) {
    function n() {
        return m(function (b, c) {
            a.user ? b() : d.init(function (c) {
                c && c.user && (a.user = c.user, b())
            }, function () {
                c()
            })
        })
    }

    var o, p = n(), q = +e.id;
    p.then(function () {
        o = +a.user.id, b.myProfile = q === o, o === q ? (b.user_profile = a.user, b.$broadcast("createProfile")) : (d.get(q, function (a) {
            a && a.user && (b.user_profile = a.user)
        }, function (a) {
        }), f.set(q, function (a) {
        }, function (a) {
        }))
    }, function () {
        function a() {
            window.location.href = "/"
        }

        d.logout(a, a)
    }), b.userPhotos = [], b.user_profile = {}, b.edit = !1, b.backgrounds = k("range")([], 0, 36), b.like = function (a, c, d) {
        var e = c || q;
        a ? g.remove(e, function (a) {
            "ok" === a.status && (d ? d.liked = !1 : b.user_profile.liked = !1)
        }, function (a) {
        }) : g.set(e, function (a) {
            "ok" === a.status && (d ? d.liked = !0 : b.user_profile.liked = !0)
        }, function (a) {
        })
    }, b.timeConverter = function (a) {
        if (+a || !a) {
            var c = parseInt(b.user_profile.age || 18), d = (new Date).getFullYear();
            b.time = "01/01/" + (d - c)
        } else b.time = a;
        var e = new Date(b.time), f = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], g = e.getFullYear(), h = f[e.getMonth()], i = e.getDate();
        return i + " " + h + " " + g
    }, b.modalShown = !1, b.showModal = function () {
        b.modalShown = !b.modalShown
    }, b.uploadFromFb = function () {
        b.showModal(), l.close()
    }, b.photosModalShown = !1, b.popup = function (a) {
        b.editCover = !1, b.user.photos.length ? (b.photosModalShown = !b.photosModalShown, b.photoIndex = a) : (b.add_photos = !0, l.open({
            template: "/views/modals/activity.photos.html",
            scope: b,
            preCloseCallback: function () {
                return !0
            }
        }))
    }, b.removePhoto = function (e, f, g, h) {
        g && (g.preventDefault(), g.stopPropagation()), e && !angular.isUndefined(f) && d.remove("photo", e, function () {
            h && j(function () {
                b.user_profile.photos.splice(f, 1), a.user.photos = b.user_profile.photos
            }, 0)
        }, function (a) {
            c.error(a)
        })
    }, b.setProfilePhoto = function (c, e) {
        c && (e && (e.preventDefault(), e.stopPropagation()), d.update({photo: c}, function (c) {
            c.user && (b.user_profile = c.user, a.user = c.user)
        }, function (a) {
        }))
    }, b.likePhoto = function (a) {
        h.photoLike(b.user_profile.id, a)
    }, b.sendMessage = function (a, c) {
        if (" " !== a && a.length) {
            var d = c || b.user_profile.id;
            i.send(d, a, function (a) {
                a.error
            }, function (a) {
            }), b.chatModalShown = !1
        }
    }, b.statusKeypress = function (a) {
        var b = angular.element(a.target), c = b.text().length;
        c > 60 && a.preventDefault()
    }
}]), app.directive("contenteditable", ["$sce", "$timeout", "$filter", "$location", function (a, b) {
    return {
        restrict: "A", require: "?ngModel", link: function (c, d, e, f) {
            function g() {
                var a = d.html();
                e.stripBr && "<br>" == a && (a = ""), f.$setViewValue(a)
            }

            f && (f.$render = function () {
                d.html(a.getTrustedHtml(f.$viewValue || ""))
            }, d.on("blur keyup change", function () {
                b(g)
            }), d.on("keydown", function (a) {
                "13" == a.which && a.preventDefault()
            }), g())
        }
    }
}]), app.directive("actCountBlock", ["ngDialog", "$timeout", "hotkeys", "News", "dom", "$document", function (a, b, c, d, e, f) {
    return {
        restrict: "A", link: function (a) {
            function g(c) {
                h[0] === c.target || e.isHidden(h) || b(function () {
                    a.showNewsDialog = !1
                })
            }

            var h = f.find(".news_feed");
            a.counter = 0, d.get(function (b) {
                b && (a.events = b, a.arrayEvents = d.arrayEvents, a.counter = a.arrayEvents.length)
            }, function (a) {
            }), a.showNewsDialog = !1, a.counterClick = function (b) {
                b.preventDefault(), b.stopPropagation(), a.showNewsDialog = !a.showNewsDialog
            }, f.bind("click", g), a.$on("$destroy", function () {
                d.arrayEvents = [], f.off("click", g)
            }), c.add({
                combo: "esc", action: "keyup", callback: function () {
                    e.isHidden(h) || (a.showNewsDialog = !1)
                }
            })
        }
    }
}]), app.directive("activeLink", ["$location", function (a) {
    return {
        restrict: "A", link: function (b, c, d) {
            var e = d.activeLink, f = "";
            f = d.ngHref ? d.ngHref : angular.element(c).find("a").attr("ng-href"), b.location = a, b.$watch("location.path()", function (a) {
                a.search(f) >= 0 ? c.addClass(e) : c.removeClass(e)
            })
        }
    }
}]), app.directive("sourceSrc", [function () {
    return {
        restrict: "A", link: function (a, b, c) {
            b.attr("src", c.sourceSrc)
        }
    }
}]), app.directive("checkList", [function () {
    return {
        restrict: "A", link: function (a, b) {
            function c() {
                b[0].style.display = a.user.geo && a.user.photos.length && a.user.interests && a.user.interests.length && angular.isObject(a.user.settings) && "undefined" != typeof a.user.settings.bdate && "undefined" != typeof a.user.settings.education && a.user.settings.education.length && "undefined" != typeof a.user.settings.work && a.user.settings.work.length && "undefined" != typeof a.user.settings.aboutMe && a.user.settings.aboutMe.length ? "none" : "block"
            }

            a.$watch("user", c, !0)
        }
    }
}]), app.directive("hideContact", ["$window", "dom", function (a, b) {
    var c = angular.element(a), d = function () {
        var a = 0;
        return function (b, c) {
            clearTimeout(a), a = setTimeout(b, c)
        }
    }(), e = function () {
        var a = document.querySelector(".contacts-list"), c = document.querySelectorAll("[hide-contact]"), d = 0;
        a = b.outerHeight(a) - 100 - 41, [].forEach.call(c, function (c) {
            var e = b.position(c).top + 38 + 44 + 35 + 20, f = c.previousElementSibling;
            c.style.visibility = e > a || d > e ? "hidden" : f && f.classList.contains("ng-hide") ? "hidden" : "visible", d = e
        })
    };
    return c.bind("resize", function () {
        d(e, 100)
    }), {
        link: function (a) {
            a.$last && e()
        }
    }
}]), app.directive("showPart", ["$location", function (a) {
    return {
        link: function (b, c, d) {
            function e(a, b) {
                var c = !0;
                return a.forEach(function (a) {
                    return a.search(b) >= 0 ? (c = !1, !1) : void 0
                }), c
            }

            function f(c) {
                var d, f = a.path();
                switch (c) {
                    case"header":
                        d = e(h, f), b.showHeader = d;
                        break;
                    case"banner":
                        d = e(i, f), b.showBanner = d;
                        break;
                    case"contactsCol":
                        d = e(j, f), b.showContactsCol = d
                }
            }

            var g = d.showPart, h = ["/", "/reset_password"], i = ["/", "/tips", "/terms", "/privacy", "/reset_password"], j = ["/", "/tips", "/terms", "/privacy", "/contacts", "/reset_password"];
            b.$on("$locationChangeStart", function () {
                f(g)
            })
        }
    }
}]), app.directive("enter", ["$timeout", function (a) {
    return function (b, c, d) {
        c.bind("keydown keypress", function (c) {
            13 === c.which && (a(function () {
                b.$eval(d.enter)
            }), c.preventDefault())
        })
    }
}]), app.directive("logoAnimate", ["browser", function (a) {
    return function () {
        function b() {
            if (r++, r === j.length) {
                var a = document.querySelector(".mantra h1");
                a && (a.className += " show")
            }
        }

        function c(a) {
            var b, c, d;
            for (b = a.length - 1; b > 0; b--)c = Math.floor(Math.random() * (b + 1)), d = a[b], a[b] = a[c], a[c] = d;
            return a
        }

        function d() {
            if (r++, r === j.length - 10) {
                r = 0;
                var d;
                c(m).forEach(function (c) {
                    d = p.path(), g.add(d), "unknown" === a() && "ie" === a() ? d.attr("stroke", "rgba(63,171,207,.7)").M(c[0].x + 28, c[0].y + 28).L(c[1].x + 28, c[1].y + 28).attr("stroke-width", "20") : d.attr("stroke", "rgba(63,171,207,.7)").M(c[0].x + 28, c[0].y + 28).L(c[1].x + 28, c[1].y + 28).Z().drawAnimated({
                        duration: 500,
                        easing: SVG.easing.quadIn,
                        delay: 0
                    }).attr("stroke-width", "20"), setTimeout(b, 600)
                })
            }
        }

        function e() {
            r++, r === j.length - 5 && (r = 0, setTimeout(function () {
                j.forEach(function (a, b) {
                    var c = 100 * Math.random() + 700;
                    a.instance.animate(c, SVG.easing.cubicInOut).attr("cx", l[b].left + 40).attr("cy", l[b].top + 40).after(d)
                })
            }, 500))
        }

        if ("firefox" === a())return document.querySelector(".logo-holder img").style.display = "block", void(document.querySelector(".mantra h1").className += " show");
        var f, g, h, i, j, k, l = [{left: 64.2296142578125, top: 0}, {
            left: .27825927734375,
            top: 0
        }, {left: 32.22039794921875, top: 0}, {
            left: 32.22039794921875,
            top: 79.05000305175781
        }, {left: 87.1795654296875, top: 79.05000305175781}, {left: 122.275634765625, top: 0}, {
            left: 153.61376953125,
            top: 78.64736938476562
        }, {left: 198.70855712890625, top: 79.05000305175781}, {
            left: 198.70855712890625,
            top: 0
        }, {left: 198.5072021484375, top: 39.524993896484375}, {
            left: 253.667724609375,
            top: 0
        }, {left: 253.667724609375, top: 79.05000305175781}, {
            left: 253.667724609375,
            top: 0
        }, {left: 291.85064697265625, top: 41.06842041015625}, {
            left: 329.9664306640625,
            top: 0
        }, {left: 329.9664306640625, top: 79.05000305175781}, {
            left: 381.83880615234375,
            top: 79.05000305175781
        }, {left: 381.83880615234375, top: 0}, {
            left: 381.83880615234375,
            top: 39.524993896484375
        }, {left: 138.31378173828125, top: 39.524993896484375}, {
            left: 104.8282470703125,
            top: 39.86053466796875
        }], m = [[{x: 12.27825927734375, y: 12}, {x: 76.2296142578125, y: 12}], [{
            x: 44.22039794921875,
            y: 12
        }, {x: 44.22039794921875, y: 91.05000305175781}], [{x: 134.275634765625, y: 12}, {
            x: 99.1795654296875,
            y: 91.05000305175781
        }], [{x: 134.275634765625, y: 12}, {x: 165.61376953125, y: 90.64736938476562}], [{
            x: 210.70855712890625,
            y: 12
        }, {x: 210.70855712890625, y: 91.05000305175781}], [{x: 265.667724609375, y: 12}, {
            x: 265.667724609375,
            y: 91.05000305175781
        }], [{x: 265.667724609375, y: 12}, {x: 303.85064697265625, y: 53.06842041015625}], [{
            x: 341.9664306640625,
            y: 12
        }, {x: 303.85064697265625, y: 53.06842041015625}], [{x: 341.9664306640625, y: 12}, {
            x: 341.9664306640625,
            y: 91.05000305175781
        }], [{x: 393.83880615234375, y: 12}, {
            x: 393.83880615234375,
            y: 91.05000305175781
        }]], n = l.slice(0), o = document.querySelector(".logo-holder img"), p = SVG("logo-holder").size(500, 150), q = n.reverse(), r = 0;
        o && o.parentNode.removeChild(o), g = p.group(), h = p.group(), q.forEach(function () {
            f = q[Math.floor(Math.random() * q.length)], i = p.circle(0), i.attr("opacity", 0), i.attr("cx", f.left + 40).attr("class", "circle").attr("cy", f.top + 40).attr("r", 0).attr("fill", "#3FABCF"), h.add(i)
        }), j = document.querySelectorAll(".circle"), j = [].slice.call(j, 0), j.forEach(function (a) {
            k = 200 * Math.random() + 400, a.instance.animate(400, SVG.easing.quadIn, k).attr({rx: "11"}).attr({ry: "11"}).attr("opacity", 1).after(e)
        })
    }
}]), app.directive("passwordVerify", function () {
    return {
        require: "ngModel", scope: {passwordVerify: "="}, link: function (a, b, c, d) {
            a.$watch(function () {
                var b;
                return (a.passwordVerify || d.$viewValue) && (b = a.passwordVerify + "_" + d.$viewValue), b
            }, function (b) {
                b && d.$parsers.unshift(function (b) {
                    var c = a.passwordVerify;
                    return c !== b ? void d.$setValidity("passwordVerify", !1) : (d.$setValidity("passwordVerify", !0), b)
                })
            })
        }
    }
}), app.directive("chatContact", ["$location", "$timeout", "$window", "dom", function (a, b, c, d) {
    return {
        restrict: "A", scope: {threadWith: "=", userId: "=", newMsg: "="}, link: function (e, f) {
            function g() {
                var a, b = document.querySelector(".messages");
                f.hasClass("active") && b && (a = d.position(f).top, b.scrollTop = a)
            }

            f.bind("click", function () {
                return angular.element(this).hasClass("active") ? !1 : void 0
            }), e.$watch("newMsg", function (b) {
                b && a.path().indexOf(e.userId) < 0 && +e.threadWith !== +e.userId && f.addClass("new-msg")
            }), e.$watch("threadWith", function (a) {
                a && +a === +e.userId && (f.addClass("active"), f.removeClass("new-msg"))
            }), b(function () {
                e.threadWith || e.$parent.threadInit(e.userId)
            }), setTimeout(g, 0);
            var h = angular.element(c);
            h.off("resize", g), h.bind("resize", g), e.$on("$destroy", function () {
                h.off("resize", g)
            })
        }
    }
}]), app.directive("chatScroll", [function () {
    return {
        restrict: "A", link: function (a, b) {
            function c() {
                var c = b[0].scrollTop;
                if (200 >= c && e > c) {
                    var d = b[0].scrollHeight;
                    a.loadMore(function () {
                        setTimeout(function () {
                            b[0].scrollTop = b[0].scrollHeight - d + 200
                        })
                    })
                }
                e = c
            }

            function d() {
                f(c)
            }

            a.$on("scrollToBottom", function () {
                setTimeout(function () {
                    b[0].scrollTop = b[0].scrollHeight
                }, 0)
            });
            var e, f = function () {
                var a = 0;
                return function (b, c) {
                    clearTimeout(a), a = setTimeout(b, c)
                }
            }();
            a.$on("initScroll", function () {
                b.bind("scroll", d)
            }), a.$on("$destroy", function () {
                b.off("scroll", d)
            })
        }
    }
}]), app.directive("messages", ["dom", "$window", function (a, b) {
    var c = function () {
        var a = 0;
        return function (b, c) {
            clearTimeout(a), a = setTimeout(b, c)
        }
    }();
    return function (d, e) {
        function f() {
            c(function () {
                g()
            }, 500)
        }

        var g = function () {
            var b, c = a.outerHeight(document.querySelector(".col-02 .form")), d = a.outerHeight(document.querySelector(".col-02 .head")), f = document.querySelectorAll(".message_wrapper"), g = a.outerHeight(document.querySelector(".chat-area")), h = 0;
            a.each(f, function (b) {
                h += a.outerHeight(angular.element(b))
            }), b = g - h - c - d, 65 > b && (b = 65), e.css("height", b + "px")
        };
        d.$watch("conv.messages", function (a) {
            a && setTimeout(g, 0)
        }, !0), angular.element(b).bind("resize", f), d.$on("$destroy", function () {
            angular.element(b).off("resize", f)
        })
    }
}]), app.directive("coversSlider", ["$window", "$document", "dom", function (a, b, c) {
    return {
        link: function (d) {
            function e() {
                f && g.setWidth(f)
            }

            var f, g = this;
            angular.element(a).bind("resize", e), this.disableButtons = function () {
                if (this.li.length) {
                    var a = c.last(this.li), b = c.position(a);
                    setTimeout(function () {
                        b.left + 50 < g.parentWidth && (g.prev.addClass("disabled"), g.next.addClass("disabled"))
                    }, 0)
                }
            }, this.setWidth = function (a) {
                f = a;
                var d = b[0].querySelector(f.attr("data-next")), e = b[0].querySelector(f.attr("data-prev"));
                this.liWidth = 0, this.next = angular.element(d), this.prev = angular.element(e), this.li = f.find("li"), this.length = g.li.length, this.liWidth = c.outerWidth(g.li), this.allWidth = g.length * g.liWidth, this.parentWidth = c.outerWidth(f.parent()), this.paddingRight = parseFloat(c.getCSS(f.parent(), "paddingRight")), this.prev.addClass("disabled"), this.next.removeClass("disabled"), f.removeClass("transition"), f.css("margin-left", 0), f.css("width", g.allWidth + "px"), f.css("visibility", "visible"), g.disableButtons(), f.addClass("transition"), this.bind()
            }, this.bind = function () {
                this.next.off().bind("click", function (a) {
                    if (a.preventDefault(), g.li = f.find("li"), !g.next.hasClass("disabled") && g.li.length) {
                        var b = c.last(g.li), d = parseFloat(c.getCSS(f, "marginLeft")), e = Math.abs(d), h = c.position(b).left + g.next[0].offsetWidth + g.liWidth + e;
                        g.parentWidth = c.outerWidth(f.parent()), c.hasClass(f, "modal") && (g.paddingRight = -60), e + 2 * g.parentWidth > g.allWidth ? (f.css("marginLeft", "-" + (h - g.parentWidth + g.paddingRight) + "px"), g.next.addClass("disabled")) : (e = -d + g.parentWidth, f.css("marginLeft", "-" + e + "px")), g.prev.removeClass("disabled")
                    }
                }), this.prev.off().bind("click", function (a) {
                    if (a.preventDefault(), !g.prev.hasClass("disabled")) {
                        g.li = f.find("li");
                        var b = c.first(g.li), d = parseFloat(c.getCSS(f, "marginLeft")), e = Math.abs(d), h = c.position(b).left + g.prev[0].offsetWidth + g.parentWidth;
                        h > 0 ? (f.css("marginLeft", 0), g.prev.addClass("disabled")) : (e = d + g.parentWidth, f.css("marginLeft", e + "px")), g.next.removeClass("disabled")
                    }
                })
            }, d.$watch("editCover", function (a) {
                if (a && !d.show) {
                    var b = document.querySelector(".patterns .list");
                    f = angular.element(b), f.css("visibility", "hidden"), setTimeout(function () {
                        c.show(f), g.setWidth(f)
                    }, 0)
                }
            }, !0), d.$watch("show", function () {
                if (d.show || f) {
                    var a = document.querySelector(".list.modal");
                    f = angular.element(a), f.css("visibility", "hidden"), setTimeout(function () {
                        c.show(f), g.setWidth(f)
                    }, 0)
                }
            }, !0), d.$on("$destroy", function () {
                angular.element(a).off("resize", e)
            })
        }
    }
}]), app.directive("facebookUploadDialog", ["$log", "$filter", "hotkeys", "$timeout", "FB", "User", "$rootScope", "$document", "$templateCache", function (a, b, c, d, e, f, g, h, i) {
    return {
        restrict: "A",
        replace: !0,
        template: i.get("views/modals/facebook.modal.html"),
        scope: {show: "="},
        controller: ["$scope", function (b) {
            b.$watch("show", function (a) {
                a && e.getAlbums(function (a) {
                    d(function () {
                        b.albums = a
                    }, 0)
                }, function (a) {
                })
            }), b.selectAlbum = function (a, c) {
                b.albumName = c, b.albumSelected = !0, e.getPhotos(a, function (a) {
                    d(function () {
                        b.photos = a, b.selectedPhotos = [], b.error = ""
                    })
                }, function (a) {
                    d(function () {
                        b.photos = [], b.selectedPhotos = [], b.error = a
                    })
                })
            }, b.upload = function () {
                if (b.selectedPhotos) {
                    var c = [];
                    angular.forEach(b.selectedPhotos, function (a) {
                        a.source && c.push(a.source)
                    }), f.upload({target: "facebook", photos: c}, function (a) {
                        if (a.user && "error" !== a.status) {
                            var c = g.user.interests || [];
                            g.user = a.user, g.user.interests = c, g.user.settings = g.user.settings || {}, b.$parent.user && (b.$parent.user.photos = a.user.photos), b.$parent.photos && (b.$parent.photos = []), b.$parent.user_profile && b.$parent.user_profile.photos && b.$parent.myProfile && (b.$parent.user_profile.photos = a.user.photos), b.show = !b.show
                        }
                    }, function (b) {
                        a.warn(b)
                    })
                }
            }
        }],
        link: function (a) {
            a.dialogStyle = {}, a.albumSelected = !1, a.$watch("show", function (b) {
                b ? h.find("html").addClass("hidden") : h.find("html").removeClass("hidden"), a.preload = !1
            }), a.hideModal = function () {
                a.show = !1
            }, a.addPhoto = function (c, d) {
                if (c)a.selectedPhotos.push(d), a.selectedPhotos = b("unique")(a.selectedPhotos, "id"); else {
                    var e = b("getById")(a.selectedPhotos, d.id);
                    if (!e)return;
                    a.selectedPhotos.splice(e.index, 1)
                }
            }, a.startUpload = function (b) {
                b || a.upload()
            }, c.add({
                combo: "esc", action: "keyup", callback: function (b) {
                    b.preventDefault(), a.show = !1
                }
            }), a.$on("$destroy", function () {
                h.find("body").off()
            })
        }
    }
}]), app.directive("focus", function () {
    return function (a, b, c) {
        c.$observe("focus", function (a) {
            "true" === a && setTimeout(function () {
                b[0].focus()
            })
        })
    }
}), app.directive("googleMap", ["$timeout", function () {
    return function (a, b, c) {
        function d() {
            if (document.getElementById("map") && (document.getElementById("map").innerHTML = ""), a.user_profile.geo.latitude && a.user_profile.geo.longtitude && google && google.maps && google.maps.StyledMapType) {
                {
                    var b = a.user_profile.geo.latitude, c = a.user_profile.geo.longtitude, d = new google.maps.StyledMapType(e), f = {
                        center: new google.maps.LatLng(b, c),
                        zoom: 7,
                        zoomControl: !1,
                        scrollwheel: !1,
                        disableDoubleClickZoom: !0,
                        disableDefaultUI: !0,
                        mapTypeControlOptions: {mapTypeIds: [google.maps.MapTypeId.ROADMAP, "map_style"]}
                    }, g = new google.maps.Map(document.getElementById("map"), f), h = new google.maps.LatLng(b, c);
                    new google.maps.Marker({position: h, map: g})
                }
                g.mapTypes.set("map_style", d), g.setMapTypeId("map_style")
            }
        }

        if (window.google && a.user_profile.geo) {
            b.css("width", c.width), b.css("height", c.height), a.$watch("tab", function (a) {
                (a || 2 !== a) && setTimeout(d, 1e3)
            }), a.$watch("user", function (a, b) {
                angular.equals(a.geo, b.geo) || d()
            });
            var e = [{
                featureType: "road",
                elementType: "labels",
                stylers: [{visibility: "off"}]
            }, {
                featureType: "water",
                elementType: "labels.text",
                stylers: [{visibility: "off"}]
            }, {
                featureType: "water",
                elementType: "geometry",
                stylers: [{visibility: "on"}, {color: "#20afd7"}]
            }, {
                featureType: "road.highway",
                elementType: "labels",
                stylers: [{visibility: "off"}]
            }, {featureType: "road", stylers: [{color: "#f1f1f1"}]}, {
                featureType: "landscape",
                stylers: [{visibility: "simplified"}, {saturation: 1}, {lightness: 36}]
            }, {
                elementType: "labels.text",
                stylers: [{visibility: "simplified"}, {color: "#000000"}]
            }, {featureType: "water", elementType: "labels", stylers: [{visibility: "off"}]}, {
                featureType: "poi",
                elementType: "labels",
                stylers: [{visibility: "off"}]
            }]
        }
    }
}]), app.directive("photosSlider", ["ngDialog", "dom", function (a, b) {
    return function (c, d, e) {
        var f = {
            init: function () {
                var a = document.querySelector(e.next), c = document.querySelector(e.prev), f = this;
                return this.width = d[0].offsetWidth, this.li = d.find("li"), this.next = angular.element(a), this.prev = angular.element(c), this.addWatcher(), !this.li.length && this.next && this.next.length ? void b.hide(this.next) : (this.bind(), d.removeClass("transition"), d.css("marginLeft", 0), f.hideButtons(), void d.addClass("transition"))
            }, addWatcher: function () {
                var a = this, b = c.$watch("user.photos", function (c, d) {
                    angular.isUndefined(c) || angular.equals(c, d) || setTimeout(function () {
                        a.init(), b()
                    }, 0)
                }, !0)
            }, hideButtons: function () {
                function a() {
                    setTimeout(function () {
                        var a = b.position(f).left + f.offsetWidth;
                        h.width = d[0].offsetWidth, a < h.width ? b.hide(h.next[0] || document.querySelector(e.next)) : b.show(h.next[0] || document.querySelector(e.next))
                    }, 0)
                }

                var c, f = b.last(d[0].querySelectorAll("li")), g = angular.element(f).find("img"), h = this;
                this.prev && this.prev.length && b.hide(this.prev), g && g.length && (c = new Image, c.src = g[0].src, c.onload = a, c.onerror = a)
            }, bind: function () {
                var a = this;
                this.next.off().bind("click", function (b) {
                    b.preventDefault(), a.nextSlide()
                }), this.prev.off().bind("click", function (b) {
                    b.preventDefault(), a.prevSlide()
                })
            }, uploadModal: function () {
                c.add_photos = !0, a.open({template: "/views/modals/activity.photos.html", scope: c})
            }, prevSlide: function () {
                var a = b.first(this.li), c = parseFloat(b.getCSS(d, "marginLeft")), e = Math.abs(c), f = b.position(a).left + e;
                f < this.width ? (d.css("marginLeft", 0), b.hide(this.prev)) : (e = c + this.width, d.css("marginLeft", e + "px")), b.show(this.next)
            }, nextSlide: function () {
                var a = b.last(this.li), e = parseFloat(b.getCSS(d, "marginLeft")), f = Math.abs(e), g = b.position(a).left - f, h = angular.isArray(c.user.photos) ? c.user.photos.length : 0, i = b.outerWidth(angular.element(a));
                return i = i || parseFloat(a.getAttribute("width")), 0 === h ? (this.uploadModal(), !1) : (2 * this.width > g ? (f = -e + (g - this.width + i), d.css("marginLeft", "-" + f + "px"), b.hide(this.next)) : (f += this.width, d.css("marginLeft", "-" + f + "px")), void b.show(this.prev))
            }
        };
        setTimeout(function () {
            f.init()
        }, 0), c.$watch(function () {
            return d[0].offsetWidth
        }, function (a) {
            if (a) {
                var c = parseFloat(b.getCSS(d, "marginLeft")), e = Math.abs(c);
                e && (f.width = a - e)
            }
        }), c.$watch("user", function (a, b) {
            angular.isUndefined(a) || angular.equals(a, b) || setTimeout(function () {
                f.init()
            }, 0)
        })
    }
}]), app.directive("profileChat", ["$templateCache", function (a) {
    return {
        restrict: "A",
        replace: !0,
        scope: {show: "=", send: "&", receiverId: "="},
        template: a.get("views/modals/message.modal.html"),
        link: function (a, b) {
            a.hideModal = function () {
                a.show = !1
            }, a.$watch("show", function (b) {
                b && (a.msg = ""), setTimeout(function () {
                    var a = document.querySelector("#message-field");
                    a && a.focus()
                }, 500)
            }), a.sendMsg = function () {
                var b = a.receiverId || null;
                a.send({msg: a.msg, id: b})
            }, b.bind("keydown keypress", function (b) {
                13 === b.which && a.msg.length && " " !== a.msg ? (a.sendMsg(), b.preventDefault()) : 27 === b.keyCode && a.hideModal()
            })
        }
    }
}]), app.directive("photosModal", ["hotkeys", "$rootScope", "$routeParams", "$document", "$templateCache", function (a, b, c, d, e) {
    return {
        restrict: "A",
        replace: !0,
        template: e.get("views/modals/profile.photos.modal.html"),
        scope: {
            show: "=",
            photos: "=",
            remove: "&",
            like: "&",
            setProfilePhoto: "&",
            index: "=photoIndex",
            myProfile: "="
        },
        link: function (e) {
            function f() {
                e.nextDisabled = e.index >= 0 && e.index < e.photos.length - 1 ? !1 : !0, e.prevDisabled = e.index <= 0
            }

            var g = !1;
            e.user_id = c.id, e.prevDisabled = !1, e.nextDisabled = !1, e.$watch("show", function (a) {
                a ? (d.find("html").addClass("hidden"), e.preload = !1, e.$parent.edit = !1) : d.find("html").removeClass("hidden")
            }), e.$watch("photos", function (a) {
                a && (e.photos = a)
            }), e.$watch("index", function (a) {
                if (!angular.isUndefined(a)) {
                    var b = e.index;
                    --b, e.liked = !1, e.photos && e.photos[e.index] && (e.photo = e.photos[e.index]), f()
                }
            }), e.profilePhoto = function (a, b) {
                d.find(a.target).hasClass("disabled") || e.setProfilePhoto({hash: b})
            }, e.mainPhoto = function (a) {
                if (a && e.show) {
                    var c = a.indexOf("/"), a = a.slice(c + 1), d = b.user.photo, f = !1;
                    return angular.forEach(d, function (b) {
                        return b.search(a) >= 0 ? (f = !0, !1) : void 0
                    }), f
                }
            }, e.setPhoto = function (a) {
                e.index = a
            }, e.removePhoto = function (a) {
                e.remove({hash: a, index: e.index}), e.photos.splice(e.index, 1);
                var b = e.index;
                e.photos[b] ? e.photo = e.photos[b] : b === e.photos.length && 0 !== b ? (e.index--, e.photo = e.photos[b]) : 0 === b && 0 === e.photos.length && e.hideModal(), f(), g = !0
            }, e.hideModal = function () {
                g && (b.user.photos = e.photos), e.show = !1
            }, e.next = function () {
                e.nextDisabled || e.index++
            }, e.prev = function () {
                e.prevDisabled || e.index--
            }, a.add({
                combo: "right", action: "keyup", callback: function (a) {
                    a.preventDefault(), e.next()
                }
            }), a.add({
                combo: "space", action: "keyup", callback: function (a) {
                    a.preventDefault(), e.next()
                }
            }), a.add({
                combo: "left", action: "keyup", callback: function (a) {
                    a.preventDefault(), e.prev()
                }
            }), a.add({
                combo: "escape", action: "keyup", callback: function (a) {
                    a.preventDefault(), e.hideModal()
                }
            })
        }
    }
}]), app.directive("replaceBr", function () {
    return {
        restrict: "A", require: "ngModel", link: function (a, b, c, d) {
            function e(a) {
                return a ? a.replace(/\n/g, "<br>") : void 0
            }

            function f(a) {
                return a ? a.replace(/<br>/g, "\n") : void 0
            }

            d.$parsers.push(e), d.$formatters.push(f)
        }
    }
}), app.directive("scrollTo", function () {
    return function (a, b) {
        b.bind("click", function () {
            window.scrollTo(0, 0)
        })
    }
}), app.directive("scroll", ["$window", "dom", function (a, b) {
    return function (c, d) {
        function e() {
            this.pageYOffset >= h ? d.addClass("fix") : d.removeClass("fix")
        }

        var f = document.querySelector("#main"), g = parseFloat(b.getCSS(f, "paddingTop")), h = 40 === g ? 267 : 240;
        angular.element(a).on("scroll", e), c.$on("$destroy", function () {
            angular.element(a).off("scroll", e)
        })
    }
}]), app.directive("resize", ["$window", "$timeout", function (a, b) {
    return function (c, d, e) {
        function f() {
            b(function () {
                c.windowHeight = a.innerHeight, c.windowWidth = a.innerWidth
            })
        }

        var g = 0, h = angular.element(document).find("body");
        c.windowHeight = a.innerHeight, c.windowWidth = a.innerWidth, angular.element(a).on("resize", f), h.hasClass("adB_enabled") && (g = 96), c.resizeWithOffset = function (a) {
            return c.$eval(e.notifier), {height: c.windowHeight - a + g - 10 + "px"}
        }, c.resizeWithOffsetWidth = function (a) {
            return c.$eval(e.notifier), {width: c.windowWidth - a + "px"}
        }, c.$on("$destroy", function () {
            angular.element(a).off("resize", f)
        })
    }
}]), app.directive("setBackground", ["$log", "$rootScope", function (a, b) {
    return {
        restrict: "A", scope: {cover: "=", random: "@", user: "="}, link: function (a, c, d) {
            var e = 20, f = 1, g = "true" === a.random;
            a.$watch("cover", function (a) {
                if (a) {
                    var d = a.indexOf(".png") >= 0 ? a : a + ".png";
                    d = d.replace(/bg(?![\s\S]*bg)/, ""), c.css({"background-image": "url(" + b.context.static_host + "/images/bg-pat/" + d + ")"})
                } else if (g) {
                    var h = Math.floor(Math.random() * (e - f + 1) + f);
                    c.css({"background-image": "url(" + b.context.static_host + "/images/bg-pat/" + h + ".png)"})
                } else c.css({"background-image": "url(" + b.context.static_host + "/images/bg-pat/1.png)"})
            }), d.user && a.$watch("user", function (b) {
                a.cover = b && b.settings ? b.settings.bg : null
            })
        }
    }
}]), app.directive("spinner", ["dom", function (a) {
    return {
        restrict: "A", scope: {photo: "="}, link: function (b, c) {
            function d(b, d) {
                if (b) {
                    d = d || {};
                    var e = b.url || b, g = d.url || d;
                    e === g ? c.triggerHandler("load") : (a.hide(c), a.show(f))
                }
            }

            var e = c.parent(), f = angular.element('<div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>');
            e.append(f), b.$watch("photo", d, !0), c.bind("load", function () {
                a.hide(f), a.show(c)
            })
        }
    }
}]), app.directive("streamSlider", ["$window", "dom", "browser", function (a, b, c) {
    return {
        restrict: "A", link: function (d, e) {
            function f() {
                var a = document.querySelector(".streamrate .photos .active");
                if (a = angular.element(a), a && a.next().length) {
                    var c = b.position(a).left, d = m[0].offsetWidth / 2 - c - j / 2;
                    e.css("marginLeft", d + "px")
                }
            }

            function g() {
                l = (j + k + 50) * i, e.css("width", l + "px"), "safari" !== c() && e.addClass("transition")
            }

            function h() {
                var a = document.querySelectorAll(".photos .block");
                a = angular.element(a);
                var c, f, g = b.last(a);
                g = angular.element(g), g && g.length && (c = parseFloat(b.getCSS(e, "marginLeft")), f = b.position(g).left + c, m[0].offsetWidth > f + j && d.getNewUsers())
            }

            var i, j, k, l, m = document.querySelector(".streamrate .photos"), m = angular.element(m);
            d.$watch("users", function (a) {
                if (a) {
                    var c = document.querySelectorAll(".photos .block");
                    c = b.not(c, "active");
                    var d = angular.element(c[0]);
                    j = parseFloat(b.getCSS(d, "width")), k = parseFloat(b.getCSS(d, "marginRight")), i = a.length, setTimeout(h, 600), g(), setTimeout(f, 0)
                }
            }), d.$on("scroll", function () {
                var a = document.querySelector(".streamrate .photos .active");
                a && (setTimeout(f, 0), setTimeout(h, 600))
            }), angular.element(a).bind("resize", f), d.$on("$destroy", function () {
                angular.element(a).off("resize", f)
            })
        }
    }
}]), app.filter("chatSorting", function () {
    return function (a) {
        if (!angular.isObject(a))return a;
        var b, c = [];
        for (b in a)c.push(a[b]);
        return c.sort(function (a, b) {
            var c = a.user.name.toLowerCase(), d = b.user.name.toLowerCase();
            return b.user.online = b.user.online || !1, a.user.online = a.user.online || !1, b.user.new_message = b.user.new_message || !1, a.user.new_message = a.user.new_message || !1, b.user.new_message - a.user.new_message !== 0 ? b.user.new_message - a.user.new_message : b.user.online - a.user.online !== 0 ? b.user.online - a.user.online : d > c ? -1 : c > d ? 1 : 0
        }), c
    }
}), app.filter("toArray", [function () {
    return function (a) {
        var b = [];
        return angular.forEach(a, function (a) {
            b.push(a)
        }), b
    }
}]), app.filter("to_trusted", [function () {
    return function (a) {
        return a
    }
}]), app.filter("replace_img", [function () {
    return function (a) {
        return a.replace(/<i[^>]*>/g, "").replace(/<\/i>/g, "")
    }
}]), app.filter("getById", function () {
    return function (a, b) {
        for (var c = a.length, d = 0; c > d; d++)if (+a[d].id === +b)return {index: d, found: a[d]};
        return null
    }
}), app.filter("getByName", function () {
    return function (a, b) {
        for (var c = a.length, d = 0; c > d; d++)if (a[d].name === b)return a[d].id;
        return null
    }
}), app.filter("range", function () {
    return function (a, b, c) {
        b = parseInt(b), c = parseInt(c);
        for (var d = b; c > d; d++)a.push(d);
        return a
    }
}), app.filter("threadFilter", function () {
    return function (a, b) {
        if (!b)return a;
        var c = b.user.name;
        if (!c || "" === c)return a;
        var d = {};
        c = c.toLowerCase();
        for (var e in a) {
            var f = a[e], g = f.user.name.toLowerCase();
            g.indexOf(c) >= 0 && (d[e] = f)
        }
        return d
    }
}), app.filter("unique", function () {
    return function (a, b) {
        var c = [], d = [];
        return angular.forEach(a, function (a) {
            var e = a[b];
            -1 === d.indexOf(e) && (d.push(e), c.push(a))
        }), c
    }
}), angular.module("bd.sockjs", []).value("SockJS", window.SockJS).provider("socketFactory", function () {
    this.$get = ["SockJS", "$timeout", function (a, b) {
        var c = function (a, c) {
            return c ? function () {
                var d = arguments;
                b(function () {
                    c.apply(a, d)
                }, 0)
            } : angular.noop
        };
        return function (b) {
            b = b || {};
            var d = b.socket || new a(b.url);
            return {
                callbacks: {}, setHandler: function (a, b) {
                    return d["on" + a] = c(d, b), this
                }, removeHandler: function (a) {
                    return delete d["on" + a], this
                }, send: function () {
                    return d.send.apply(d, arguments)
                }, close: function () {
                    return d.close.apply(d, arguments)
                }
            }
        }
    }], this.$get.$inject = ["SockJS", "$timeout"]
}), angular.module("http.tracking", []).config(["$httpProvider", function (a) {
    a.interceptors.push("saHttpActivityInterceptor")
}]).factory("saHttpActivityInterceptor", ["$q", "gaTracker", "$rootScope", function (a, b) {
    var c = function (a) {
        return (+a / 1e3).toFixed(2)
    }, d = function (a) {
        if (!a || "string" != typeof a)return "unknown";
        var b = a.split("/");
        return b = b[b.length - 1], b.indexOf("?") >= 0 && (b = b.substring(0, b.indexOf("?"))), b
    };
    return {
        request: function (a) {
            return (a.url.indexOf("api/") >= 0 || a.url.indexOf("views/") >= 0) && (a.requestTimestamp = (new Date).getTime()), a
        }, response: function (a) {
            if (a.config && (a.config.url.indexOf("api/") >= 0 || a.config.url.indexOf("views/") >= 0) && a.config.requestTimestamp) {
                {
                    var b = (new Date).getTime() - a.config.requestTimestamp;
                    a.config.url.indexOf("api/") >= 0 ? "api" : "views", a.config.url.indexOf("api/") >= 0 ? a.config.url : d(a.config.url)
                }
                b = c(b) + "s"
            }
            return a
        }, responseError: function (c) {
            return c.config && b.exception({
                url: c.config.url,
                statusText: c.statusText,
                method: c.config.method
            }), a.reject(c)
        }
    }
}]), angular.module("page.visibility", []).factory("pageVisibility", function () {
    function a() {
        d = document[b]
    }

    var b, c, d = !0;
    return "undefined" != typeof document.hidden ? (b = "hidden", c = "visibilitychange") : "undefined" != typeof document.mozHidden ? (b = "mozHidden", c = "mozvisibilitychange") : "undefined" != typeof document.msHidden ? (b = "msHidden", c = "msvisibilitychange") : "undefined" != typeof document.webkitHidden && (b = "webkitHidden", c = "webkitvisibilitychange"), ("undefined" != typeof document.addEventListener || "undefined" != typeof document[b]) && document.addEventListener(c, a, !1), {
        visible: function () {
            return d
        }
    }
}), angular.module("routes", []).config(["$routeProvider", "$locationProvider", function (a, b) {
    var c = function (a, b) {
        if (b.user)if ("/" === a.path() && b.user)a.path("/stream"); else {
            if (b.user.id)return !0;
            a.path("/")
        } else a.path("/")
    }, d = function (a, b, c, d) {
        var e = b.path(), f = e.split("/").pop(), g = c.defer();
        return !f && d.user ? (g.reject(), b.path("/profile/" + d.user.id)) : f || (g.reject(), b.path("/stream")), d.user && parseInt(f) === parseInt(d.user.id) ? a.getMy(f, function (a) {
            a && a.interests && (d.user.interests = a.interests), g.resolve()
        }, function () {
            g.resolve()
        }) : g.resolve(), g.promise
    }, e = function (a, b) {
        var c = b.defer();
        return a.get(function () {
            c.resolve()
        }, function () {
            c.resolve()
        }), c.promise
    };
    c.$inject = ["$location", "$rootScope"], d.$inject = ["Interests", "$location", "$q", "$rootScope"], e.$inject = ["Messages", "$q"], b.html5Mode(!0), a.when("/", {
        templateUrl: "views/login.html",
        controller: "LoginCtrl",
        resolve: {factory: c}
    }).when("/stream/:id?", {
        templateUrl: "views/stream.html",
        controller: "StreamCtrl",
        resolve: {factory: c}
    }).when("/messages/:id?", {
        templateUrl: "views/messages.html",
        controller: "MessagesCtrl",
        resolve: {factory: c, chat: e}
    }).when("/profile/:id", {
        templateUrl: "views/profile/profile.html",
        controller: "ProfileCtrl",
        resolve: {factory: c, interests: d}
    }).when("/contacts", {
        templateUrl: "views/contacts.html",
        controller: "ContactsCtrl",
        resolve: {factory: c}
    }).when("/reset_password/:id/:hash", {
        templateUrl: "views/reset.password.html",
        controller: "LoginCtrl"
    }).when("/terms", {templateUrl: "views/terms.html"}).when("/privacy", {templateUrl: "views/privacy.html"}).when("/tips", {templateUrl: "views/tips.html"}).when("/world", {
        templateUrl: "views/world.html",
        controller: "WorldCtrl"
    }).otherwise({redirectTo: "/stream"})
}]), angular.module("timing", []).factory("Timing", function () {
    var a = {};
    return a.getTimes = function (a) {
        var b = window.performance || window.webkitPerformance || window.msPerformance || window.mozPerformance;
        if (!b)return null;
        var c = b.timing, d = {};
        if (a = a || {}, c) {
            if (a)for (var e in c)c.hasOwnProperty(e) && (d[e] = c[e]);
            if (void 0 === d.firstPaint) {
                var f = 0;
                window.chrome && window.chrome.loadTimes ? (f = 1e3 * window.chrome.loadTimes().firstPaintTime, d.firstPaintTime = f - 1e3 * window.chrome.loadTimes().startLoadTime) : "number" == typeof window.performance.timing.msFirstPaint && (f = window.performance.timing.msFirstPaint, d.firstPaintTime = f - window.performance.timing.navigationStart), a && !a.simple && (d.firstPaint = f)
            }
            d.loadTime = c.loadEventEnd - c.navigationStart, d.domReadyTime = c.domComplete - c.domInteractive, d.readyStart = c.fetchStart - c.navigationStart, d.redirectTime = c.redirectEnd - c.redirectStart, d.appcacheTime = c.domainLookupStart - c.fetchStart, d.unloadEventTime = c.unloadEventEnd - c.unloadEventStart, d.lookupDomainTime = c.domainLookupEnd - c.domainLookupStart, d.connectTime = c.connectEnd - c.connectStart, d.requestTime = c.responseEnd - c.requestStart, d.initDomTreeTime = c.domInteractive - c.responseEnd, d.loadEventTime = c.loadEventEnd - c.loadEventStart
        }
        return d
    }, a.convertToSecond = function (a) {
        return (+a / 1e3).toFixed(2)
    }, a.printTable = function (b) {
        var c = {}, d = this.getTimes(b);
        Object.keys(d).sort().forEach(function (b) {
            c[b] = {ms: d[b], s: +a.convertToSecond(d[b])}
        })
    }, window.timing = window.timing || a, a
}), app.factory("achievements", [function () {
    return {
        create: function () {
        }
    }
}]), app.factory("Alerts", ["$rootScope", "$timeout", function (a, b) {
    return a.alerts = a.alerts || [], a.closeAlert = function (b) {
        a.alerts.splice(b, 1)
    }, {
        add: function (c) {
            c && (c.index = Math.random(), a.alerts = [], a.alerts.push(c), this.close(c), b(angular.noop))
        }, close: function (c) {
            this.timer && b.cancel(this.timer), this.timer = b(function () {
                angular.forEach(a.alerts, function (b, d) {
                    b.index === c.index && a.closeAlert(d)
                })
            }, 7e3)
        }
    }
}]), app.factory("Geo", ["$http", function (a) {
    return {
        countries: function (b, c) {
            a.get("/api/helpers/countries").success(b).error(c)
        }, cities: function (b, c, d) {
            a.get("/api/helpers/cities/" + b).success(c).error(d)
        }, languages: function (b, c) {
            a.get("/api/helpers/languages").success(b).error(c)
        }
    }
}]), app.factory("Interests", ["$http", function (a) {
    return {
        categories: [], my: [], get: function (b, c) {
            var d = this;
            a.get("/api/interests/").success(function (a) {
                a && a.interests && (d.categories = a.interests, b())
            }).error(c)
        }, getMy: function (b, c, d) {
            var e = this;
            a.get("/api/interests/" + (b || "")).success(function (a) {
                a && a.interests && (e.my = a.interests, c(a))
            }).error(d)
        }, getInterests: function (b, c, d, e) {
            a.get("/api/interests/" + b + "/" + c).success(d).error(e)
        }, save: function (b, c, d) {
            a.post("/api/interests/", b).success(c).error(d)
        }, remove: function (b, c, d) {
            a["delete"]("/api/interests/", {data: b}).success(c).error(d)
        }
    }
}]), app.factory("Likes", ["$http", function (a) {
    var b = !1;
    return {
        get: function (c, d) {
            b || (b = !0, a.get("/api/likes/").success(c).error(d))
        }, set: function (b, c, d) {
            a.post("/api/likes/" + b).success(c).error(d)
        }, remove: function (b, c, d) {
            a["delete"]("/api/likes/" + b).success(c).error(d)
        }
    }
}]), app.factory("Messages", ["$http", "$rootScope", "$timeout", "User", "$location", "$q", "$filter", function (a, b, c, d, e, f, g) {
    return linkify.truncate_length = 40, {
        conversations: {},
        queueLoad: !1,
        queueGet: !1,
        offset: 0,
        loadMore: !0,
        unread: {},
        queue: [],
        getConversations: function () {
            return this.conversations
        },
        callSuccess: function () {
            this.queue.forEach(function (a) {
                a()
            }), this.queue = []
        },
        get: function (b, c) {
            if (this.queueGet)return this.queue.push(b), !1;
            this.queueGet = !0;
            var d = this, e = Object.keys(this.conversations);
            e.length ? (this.queueGet = !1, d.callSuccess(), b()) : a.get("/api/messages").success(function (a) {
                d.queueGet = !1, d.callSuccess(), d.addConversation(a.conversations), b()
            }).error(c)
        },
        load: function (b, c, d, e) {
            var f = this;
            this.queueLoad || (this.queueLoad = !0, a.get("/api/thread/" + b + "/" + c).success(function (a) {
                a && a.thread && (f.offset += a.thread.messages.length, f.loadMore = a.thread.messages.length >= 30, a.thread.messages = f.concatMessages(a.thread.messages), f.conversations[b] && (f.conversations[b].conv = a.thread)), d(a), f.queueLoad = !1
            }).error(function () {
                f.queueLoad = !1, e()
            }))
        },
        send: function (b, c, d, e) {
            var f = this;
            a.post("/api/thread/" + b, {msg: c}).success(function (a) {
                f.addMessage(b, a)
            }).success(d).error(e)
        },
        remove: function (b, c, d) {
            a["delete"]("/api/thread/" + b).success(c).error(d)
        },
        clearUnread: function (a) {
            (+this.threadWith === +a || e.path().search(a) >= 0) && delete this.unread[a]
        },
        addConversation: function (a) {
            var b = this;
            angular.extend(this.conversations, a), angular.forEach(this.conversations, function (a) {
                "0" === a.read && (b.conversations[a.user_id].user.new_message = !0, a.read = "1")
            })
        },
        addUnread: function (a) {
            (+this.threadWith !== +a || e.path().search(a) < 0) && (this.unread[a] = this.unread[a] ? this.unread[a] + 1 : 1)
        },
        initUser: function () {
            return f(function (a, c) {
                d.init(function (c) {
                    c && c.user && (b.user = c.user, a())
                }, function () {
                    c()
                })
            })
        },
        addUser: function (a, c) {
            var f, g = this, h = {messages: [], user_id: a.toString()}, i = a.toString();
            !g.conversations[i] && i ? d.get(i, function (a) {
                a.user && (g.conversations[i] = {
                    last_message: "",
                    last_message_date: "",
                    read: 0,
                    type: 1,
                    user: a.user,
                    user_id: i
                }, h.user = a.user, g.conversations[i].conv = h, g.loadMore = !1, c && c())
            }, function (a) {
            }) : g.conversations[i] && (f = g.initUser(), f.then(function () {
                g.load(i, g.offset, function (a) {
                    a.thread && (g.conversations[i].conv = a.thread, g.conversations[i].conv.messages = g.concatMessages(g.conversations[i].conv.messages), g.conversations[i].user.new_message = !1, c && c())
                })
            }, function () {
                b.user = null, e.path("/")
            }))
        },
        addMessage: function (a, b) {
            var d = +a, f = this;
            (!b || b.m) && (this.conversations[d] && this.conversations[d].hasOwnProperty("last_message") ? this.conversations[d].conv ? (this.conversations[d].conv.messages = this.conversations[d].conv.messages || [], this.conversations[d].conv.messages.push(b)) : (this.conversations[d].conv = {}, this.conversations[d].conv.messages = [b]) : this.addUser(d, function () {
                f.conversations[d].conv.messages = [b], f.lastMessage(d, b), e.path().indexOf(d.toString()) < 0 && f.conversations[d].user && (f.conversations[d].user.new_message = !0, f.conversations[d].user.online = !0)
            }), this.lastMessage(d, b), e.path().search("messages") < 0 && (this.threadWith = null), c(function () {
                f.clearUnread(b.s)
            }))
        },
        lastMessage: function (a, b) {
            if (this.conversations[a]) {
                var c = new Date, d = this.addZero(c.getHours()) + ":" + this.addZero(c.getMinutes());
                b.m = linkify.linkify(b.m), b.m = this.trim(b.m), b.d = d, this.conversations[a].last_message = b.m, this.conversations[a].last_message_date = b.d || d, this.concatLastMessage(this.conversations[a])
            }
        },
        concatLastMessage: function (a) {
            var b = a.conv;
            if (b.messages.length < 2)b.messages[0].m = b.messages[0].m.split(); else {
                var c = b.messages[b.messages.length - 1], d = b.messages[b.messages.length - 2], e = this.getDifTime(c.ts, d.ts);
                +c.s === +d.s && 1 > e ? (d.m = angular.isArray(d.m) ? d.m : d.m.split(), d.m.push(c.m), b.messages.splice(b.messages.length - 1, 1)) : c.m = angular.isArray(c.m) ? c.m : c.m.split()
            }
        },
        getDifTime: function (a, b) {
            var c = isNaN(1e3 * a) ? this.converToDate(a).getTime() : new Date(1e3 * a), d = isNaN(1e3 * b) ? this.converToDate(b).getTime() : new Date(1e3 * b), e = c - d;
            return Math.floor(e / 61e3)
        },
        converToDate: function (a) {
            if (!a)return new Date;
            var b = a.substr(0, a.indexOf(" ")), c = b.split("-");
            return new Date(c[0], c[1], c[2])
        },
        updateContacts: function (a) {
            var b = this;
            this.conversations[a] && this.conversations[a].user && (this.conversations[a].user.online = !0, this.conversations[a].user.new_message = !1, this.conversations[a].user.typing = !1, c(function () {
                e.path().indexOf(a) < 0 && (b.conversations[a].user.new_message = !0)
            }, 0), this.addUnread(a))
        },
        concatMessages: function (a) {
            var b, c, d, e, f = g("toArray")(a), h = f.length, i = [], j = 0, k = function (a, b) {
                return a ? +a.s === +b ? !0 : !1 : !0
            };
            for (j; h > j; j++)if (f[j] && f[j].m) {
                for (c = f[j].ts, b = +f[j].s, f[j].m = this.trim(f[j].m), f[j].m = linkify.linkify(f[j].m), f[j].m = f[j].m.split(), d = j + 1; h > d; d++)if (d !== j && f[d] && f[d].m) {
                    if (e = f[d], !(+e.s === b && k(f[d - 1], b) && this.getDifTime(e.ts, c) < 1))break;
                    f[d].m = this.trim(f[d].m), f[j].m.push(f[d].m), f[d] = null
                }
                i.push(f[j])
            }
            return i
        },
        trim: function (a) {
            return a && a.trim ? a.trim() : a
        },
        clearConversations: function () {
            var a;
            angular.forEach(this.conversations, function (b) {
                a = b.conv, a && a.messages && (a.messages.length = 0)
            })
        },
        addZero: function (a) {
            return 10 > a && (a = "0" + a), a
        }
    }
}]), app.factory("News", ["$http", "$timeout", function (a, b) {
    return {
        data: {}, arrayEvents: [], timeConverter: function (a) {
            if (a) {
                var b = new Date(1e3 * a), c = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], d = b.getFullYear(), e = c[b.getMonth()], f = b.getDate();
                return f + " " + e + " " + d
            }
        }, toArray: function (a) {
            if (a) {
                var b = this;
                angular.forEach(a, function (a) {
                    angular.isArray(a) && (b.arrayEvents = b.arrayEvents.concat(a))
                }), this.generateTime()
            }
        }, generateTime: function () {
            var a = this;
            this.arrayEvents.forEach(function (b) {
                b.ts = a.timeConverter(b.ts ? b.ts : (new Date).getTime() / 1e3)
            }), this.sortByDate()
        }, sortByDate: function () {
            this.arrayEvents.sort(function (a, b) {
                return new Date(b.ts).getTime() - new Date(a.ts).getTime()
            }), b(angular.noop)
        }, get: function (b, c) {
            var d = this;
            a.get("/api/news/").success(function (a) {
                if (!a || !a.news)return void c("news respond error", a);
                var e = {likes: [], visitors: [], rates: []};
                a.news.forEach(function (a) {
                    var b = a;
                    switch (b.uid = +b.uid, b.type) {
                        case"like":
                            e.likes.push(a), b.type = "Liked";
                            break;
                        case"visitor":
                            e.visitors.push(a), b.type = "Visited";
                            break;
                        case"reates":
                            e.rates.push(a), b.type = "Rated"
                    }
                }), d.toArray(e), d.data = e, b(e)
            }).error(c)
        }
    }
}]), app.factory("Notifications", ["$location", "User", "$compile", "$timeout", "pageVisibility", "Notification", function (a, b, c, d, e, f) {
    return {
        notification: {}, add: function (b, c) {
            var d = a.path(), f = this, g = {};
            if (this.scope = c, !(d.search("messages") >= 0 && e.visible())) {
                if (!e.visible() && d.search("messages") >= 0)return void this.playSound();
                g.photo = b.p, g.message = b.m, g.time = this.convertTime(b.ts), this.getUser(b.s, function (a) {
                    g.sender = a, f.notification = g, f.scope.notification = f.notification, f.compile()
                })
            }
        }, compile: function () {
            if (document.querySelector("#newmessage")) {
                var a = document.querySelector("#newmessage").innerHTML, b = c(a)(this.scope), e = this;
                d(function () {
                    e.createNotifications(angular.element(b).html())
                }, 0)
            }
        }, createNotifications: function (a) {
            f.success({
                delay: 2e4,
                template: '<div class="ui-notification"><h3 ng-show="title" ng-bind-html="title"></h3><div class="message" ng-bind-html="message"></div></div>',
                message: a
            }), this.playSound()
        }, getUser: function (a, c) {
            b.get(a, function (a) {
                a.user && c(a.user)
            }, function (a) {
            })
        }, convertTime: function (a) {
            if (a) {
                var b = a.indexOf(" ");
                return a.slice(b)
            }
            var c = new Date, d = c.getHours(), e = c.getMinutes();
            return d + ":" + e
        }, playSound: function () {
            var a = document.getElementById("messageSound");
            a && a.play && (a.load(), a.play())
        }
    }
}]), app.factory("Rates", ["$http", function (a) {
    var b = !1;
    return {
        users: [], myLikes: [], count: -1, get: function (b, c) {
            a.get("/api/rate/my").success(b).error(c)
        }, getMy: function (b, c, d) {
            var e = this;
            a.get("/api/rate/random/" + b).success(function (a) {
                a && a.users && (e.myLikes = a.users, c())
            }).error(d)
        }, set: function (b, c, d) {
            a.post("/api/rate/" + b).success(c).error(d)
        }, getUsers: function (c, d, e) {
            var f = this, g = c ? "/api/rate/" + c : "/api/rate/";
            b || (b = !0, a.get(g).success(function (a) {
                return a.error ? void e(a.error) : (a.users && (f.users = f.users.concat(a.users), d()), void(b = !1))
            }).error(e))
        }, getUser: function (a) {
            return this.users[a]
        }, photoLike: function (b, c) {
            a.post("/api/photos/rate/" + b, {photo_url: c})
        }
    }
}]), app.factory("User", ["$http", "$rootScope", function (a, b) {
    return {
        init: function (b, c) {
            a.get("/api/user").success(b).error(c)
        }, pixel: function (b) {
            b && a.get("/api/user/pixel/show").success(function (a) {
                a && a.pixel && angular.element(document).find("body").append(a.pixel)
            })
        }, register: function (c, d, e) {
            a.get("/api/user/signup", {params: c}).success(function (a) {
                a.error && e(a.error), a.user && (b.user = a.user, d(a.user))
            })
        }, login: function (b, c, d) {
            a.get("/api/user/login", {params: b}).success(function (a) {
                a.error && d(a.error), a.user && c(a.user)
            })
        }, provider: function (b, c, d) {
            a.post("/api/user/oauth", b).success(function (a) {
                a.user && c(a.user), a.error
            }).error(d)
        }, logout: function (b, c) {
            a.get("/api/user/logout").success(b).error(c)
        }, get: function (c, d, e) {
            a.get("/api/user/" + c).success(d).error(function (a) {
                b.error = a, e(a)
            })
        }, update: function (c, d, e) {
            a.put("/api/user", c).success(d).error(function (a) {
                b.error = a, e(a)
            })
        }, upload: function (b, c, d) {
            a.post("/api/user/upload", b).success(c).error(function (a) {
                d(a)
            })
        }, remove: function (b, c, d, e) {
            var f = "/api/user/";
            switch (b) {
                case"photo":
                    f += "photo?hash=" + c
            }
            a["delete"](f).success(d).error(e)
        }, forgot: function (b, c, d) {
            a.post("/api/user/password/reset", b).success(c).error(d)
        }, passwordUpdate: function (b, c, d) {
            a.post("/api/user/password/set", b).success(c).error(d)
        }
    }
}]), app.service("browser", ["$window", function (a) {
    return function () {
        var b = a.navigator.userAgent || "", c = {
            chrome: /chrome/i,
            safari: /safari/i,
            firefox: /firefox/i,
            ie: /internet explorer/i
        };
        for (var d in c)if (c[d].test(b))return d;
        return "unknown"
    }
}]), app.service("dom", [function () {
    return {
        isHidden: function (a) {
            var b = a[0] || a;
            return null === b.offsetParent
        }, hide: function (a) {
            if (a) {
                var b = a[0] || a;
                b.style.display = "none"
            }
        }, show: function (a) {
            var b = a[0] || a;
            b.style.display = "block"
        }, last: function (a) {
            return a && a.length ? a[a.length - 1] : void 0
        }, first: function (a) {
            return a && a.length ? a[0] : void 0
        }, getCSS: function (a, b) {
            var c, d = a[0] || a;
            try {
                c = getComputedStyle(d)
            } catch (e) {
            }
            return c ? c[b] : {}
        }, outerWidth: function (a) {
            if (a.length) {
                var b = a[0], c = b.offsetWidth, d = getComputedStyle(b);
                return c += parseInt(d.marginLeft || 0, 10) + parseInt(d.marginRight || 0, 10), c += parseInt(d.paddingLeft || 0, 10) + parseInt(d.paddingRight || 0, 10)
            }
        }, outerHeight: function (a) {
            if (a) {
                var b = a[0] || a, c = b.offsetHeight, d = getComputedStyle(b);
                return c += parseInt(d.marginTop || 0, 10) + parseInt(d.marginBottom || 0, 10), c += parseInt(d.paddingTop || 0, 10) + parseInt(d.paddingRight || 0, 10)
            }
        }, position: function (a) {
            if (a) {
                var b = a[0] || a;
                return {left: b.offsetLeft, top: b.offsetTop}
            }
        }, offset: function (a) {
            var b = a[0] || a, c = b.getBoundingClientRect();
            return {top: c.top + document.body.scrollTop, left: c.left + document.body.scrollLeft}
        }, not: function (a, b) {
            var c = [], d = !1, e = this;
            return [].forEach.call(a, function (a) {
                d = e.hasClass(a, b), d || c.push(a)
            }), c
        }, hasClass: function (a, b) {
            var c = a[0] || a;
            return c.classList ? c.classList.contains(b) : new RegExp("(^| )" + b + "( |$)", "gi").test(c.className)
        }, each: function (a, b) {
            [].forEach.call(a, function (a) {
                b(a)
            })
        }
    }
}]), app.factory("FB", ["$q", function (a) {
    return {
        getAlbums: function (b, c) {
            function d() {
                hello("facebook").api("me/albums").then(function (a) {
                    return !a || a.error ? c("Could not open albums from facebook") : a.data && 0 !== a.data.length ? void b(a.data) : c("There are no albums in account")
                }, function (a) {
                    c(a.error.message)
                })
            }

            var e = function () {
                var b = a.defer();
                return hello("facebook").api("me").then(function (a) {
                    b.resolve(a)
                }, function (a) {
                    b.reject(a)
                }), b.promise
            };
            e().then(function () {
                d()
            }, function () {
                hello.login("facebook").then(function () {
                    d()
                }, function (a) {
                    c(a.error.message)
                }, {scope: "photos"})
            })
        }, getPhotos: function (a, b, c) {
            var d = [], e = 0;
            hello("facebook").api("me/album", {id: a}, function (a) {
                if (a.error)return void c(a.error.message);
                if (!a.data || 0 === a.data.length)return void c("There are no photos in this album");
                for (e = 0; e < a.data.length; e++)d.push(a.data[e]);
                b(d)
            })
        }, userInfo: function (a) {
            var b = "user_about_me,user_work_history,user_education_history", c = "", d = "", e = {}, f = this;
            hello.login("facebook", {scope: b}, function (b) {
                hello(b.network).api("/me").then(function (b) {
                    b && (b.bio && (e.aboutMe = b.bio), b.education && (b.education.forEach(function (a) {
                        a.school && (c += a.school.name), a.type && (c += " " + a.type), c += "<br>"
                    }), e.education = c), b.work && b.work.forEach(function (a) {
                        a.position && (d += a.position.name), a.employer && (d += " " + a.employer.name), a.location && (d += " " + a.location.name), d += "<br>", e.work = d
                    }), f.synchronizeResult = e, a(e))
                })
            })
        }
    }
}]), app.factory("favicoService", [function () {
    var a = new Favico({animation: "fade"}), b = function (b) {
        a.badge(b)
    }, c = function () {
        a.reset()
    };
    return {badge: b, reset: c}
}]), app.factory("gaTracker", ["$rootScope", function (a) {
    return {
        track: function (b, c, d, e) {
            if (a.context && !a.context.debug) {
                var f = {hitType: "event", eventCategory: b, eventAction: c};
                "undefined" != typeof d && (f.eventLabel = d), "undefined" != typeof e && (f.eventValue = e), "function" == typeof ga && ga("send", f)
            }
        }, exception: function (b) {
            a.context && !a.context.debug && ga && ga("send", "exception", {
                exDescription: "response error",
                exFatal: !0,
                url: b.url,
                method: b.method,
                statusText: b.statusText
            })
        }, timing: function (b) {
            a.context && !a.context.debug && ga && ga("send", {
                hitType: "timing",
                timingCategory: "api",
                timingVar: b.url,
                timingValue: b.time,
                timingLabel: b.geo()
            })
        }
    }
}]), app.factory("sockjs", ["$rootScope", "socketFactory", function (a, b) {
    var c = {
        socket: {}, time: 0, crashing: !0, watch: function () {
            var b = this, c = a.$watch("user", function (a) {
                a && (b.init(), c())
            })
        }, init: function () {
            var c = new SockJS(a.context.chatUrl + "/echo", !1, {debug: !1});
            this.socket = b({socket: c}), this.handlers()
        }, send: function (a) {
            this.socket.send(a)
        }, clearTimer: function () {
            var a = this;
            a.timer && (clearTimeout(a.timer), a.timer = 0)
        }, handlers: function () {
            var b = this;
            this.socket.setHandler("open", function () {
                b.clearTimer(), b.time = 0, b.crashing = !1, b.socket.send(JSON.stringify({
                    type: "auth",
                    user_id: a.user.id,
                    user_data: a.user
                }))
            }), this.socket.setHandler("close", function () {
                b.crashing = !0, b.timer || (b.time += 1500, b.timer = setTimeout(function () {
                    b.clearTimer(), b.init()
                }, b.time))
            }), this.socket.setHandler("message", function (a) {
                var b;
                try {
                    b = JSON.parse(a.data)
                } catch (d) {
                }
                if (b.hasOwnProperty("type"))switch (b.type) {
                    case"typing":
                        c.type && c.type(b);
                        break;
                    case"in.chat":
                        break;
                    case"in.chat.confirm":
                        break;
                    case"out.chat":
                } else c.message && c.message(b)
            })
        }
    };
    return c.watch(), c.messages = function (a) {
        a && (c.message = a)
    }, c.typing = function (a) {
        a && (c.type = a)
    }, c
}]), app.factory("Visitors", ["$http", function (a) {
    var b = !1;
    return {
        get: function (c, d, e) {
            b || (b = !0, a.get("/api/visitors").success(function (a) {
                b = !1, d(a)
            }).error(e))
        }, set: function (b, c, d) {
            a.post("/api/visitors/" + b).success(c).error(d)
        }, remove: function (b, c, d) {
            a["delete"]("/api/visitors/" + b).success(c).error(d)
        }
    }
}]), app.factory("Contacts", ["$http", function (a) {
    return {
        get: function (b, c) {
            a.get("/api/contacts").success(b).error(c)
        }
    }
}]), angular.module("templates-desktop", ["views/modals/facebook.modal.html", "views/modals/message.modal.html", "views/modals/profile.photos.modal.html"]), angular.module("views/modals/facebook.modal.html", []).run(["$templateCache", function (a) {
    a.put("views/modals/facebook.modal.html", '<div class="ng-modal" ng-show="show">\n\n    <div class="overlay animated fadeIn" ng-click="hideModal()"></div>\n\n    <div class="modal-fb animated fadeInDown">\n        <div class="content">\n            <div class="header">\n                <div>Upload new photos from facebook</div>\n                <div class="close" ng-click="hideModal()"></div>\n            </div>\n            <div class="content-wrapper">\n                <div class="gallery albums" ng-hide="albumSelected">\n                    <div class="cont-title">Albums</div>\n                    <div class="cent"></div>\n                    <div class="album" ng-repeat="album in albums"\n                         ng-click="selectAlbum(album.id,album.name);  albumSelected = true;">\n                        <div class="stripe three"></div>\n                        <div class="stripe two"></div>\n                        <div class="stripe"></div>\n                        <div class="thumbnail">\n                            <img ng-src="{{album.thumbnail}}" alt="{{album.name}}" ng-if="album.thumbnail"/>\n                        </div>\n                        <div class="title" ng-bind="album.name">{{album.name}}</div>\n                    </div>\n                </div>\n                <div class="gallery inner" ng-show="albumSelected">\n                    <div class="cont-title">{{albumName}}</div>\n                    <div class="cent">\n                        <div class="blulink back" ng-click="albumSelected = false;"\n                             ng-show="albumSelected">Back to albums\n                        </div>\n                        <div class="btn save"\n                             ng-hide="preload"\n                             ng-show="selectedPhotos.length && albumSelected"\n                             ng-click="startUpload(preload); preload=true;">Upload selected\n                        </div>\n                        <div class="btn loading-btn save" ng-show="preload">\n                            Loading <span>.</span><span>.</span><span>.</span>\n                        </div>\n                    </div>\n                    <div class="album" ng-repeat="photo in photos"\n                         ng-click="photo.active = !photo.active; addPhoto(photo.active, photo);"\n                         ng-class="{\'active\' : photo.active}">\n                        <div class="thumbnail">\n                            <img ng-src="{{photo.thumbnail}}" alt="{{photo.name}}"/>\n                        </div>\n                    </div>\n                    <p class="errors">{{error}}</p>\n                </div>\n            </div>\n\n        </div>\n    </div>\n\n </div>')
}]), angular.module("views/modals/message.modal.html", []).run(["$templateCache", function (a) {
    a.put("views/modals/message.modal.html", '<div class="ng-modal" ng-show="show">\n    <div class="overlay msg animated fadeIn" ng-click="hideModal()"></div>\n    <div class="modal-fb modal-msg animated fadeInDown">\n        <a href="" class="close_modal" ng-click="hideModal()"></a>\n\n        <div class="content">\n            <div id="msg-form">\n                <div class="form">\n                    <form action="#">\n                        <div class="row">\n                            <div id="message-field" class="textarea"\n                                 ng-model="msg"\n                                 ng-trim="true"\n                                 contenteditable></div>\n                            <input class="btn blue" type="button" value="Send"\n                                   ng-class="{disabled : !msg.length || msg === \' \'}"\n                                   ng-disabled="!msg.length || msg === \' \'"\n                                   ng-click="sendMsg();">\n                        </div>\n                        <!-- / row -->\n                    </form>\n                </div>\n            </div>\n            <!-- msg-form -->\n        </div>\n    </div>\n</div>')
}]), angular.module("views/modals/profile.photos.modal.html", []).run(["$templateCache", function (a) {
    a.put("views/modals/profile.photos.modal.html", '<div class="ng-modal" ng-show="show">\n\n    <div class="overlay animated fadeIn" ng-click="hideModal()" ></div>\n    <div class="modal-photos" ng-style="resizeWithOffset(220)" resize>\n        <div class="content">\n            <div class="buttons">\n                <div class="btn black"\n                     ng-class="{liked : liked}"\n                     ng-hide="myProfile"\n                     ng-click="like({hash : photo.hash}); liked=true;">Like</div>\n                <div class="btn black" ng-show="myProfile" ng-click="removePhoto(photo.hash);">Delete</div>\n                <a class="btn black" ng-hide="myProfile" ng-href="/messages/{{user_id}}">Message</a>\n                <div class="btn black"\n                     ng-class="{\'disabled\' : mainPhoto(photo.hash)}"\n                     ng-show="myProfile;"\n                     ng-click="profilePhoto($event, photo.hash);">set to profile photo </div>\n            </div>\n            <div class="lb-nav">\n                <a href="" class="lb-next" ng-click="next();" ng-hide="nextDisabled;"></a>\n                <a href="" class="lb-prev" ng-click="prev();" ng-hide="prevDisabled;"></a>\n            </div>\n            <div class="wrapper_photo">\n                <a href="" class="close_modal" ng-click="hideModal();"></a>\n                <img ng-src="{{photo.sizes.o}}" alt="{{photo.url}}" spinner data-photo="photo"/>\n            </div>\n            <div class="wrap" ng-if="show">\n                <a href="" class="next"></a>\n                <a href="" class="prev"></a>\n                <div class="wrap-list">\n                    <ul class="list modal" data-covers-slider data-next=".modal-photos .next" data-prev=".modal-photos .prev">\n                        <li ng-repeat="p in photos" ng-class="{active : p.sizes.o === photo.sizes.o}">\n                            <a href="" ng-click="setPhoto($index)">\n                                <img ng-src="{{p.sizes.p}}" />\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')
}]);
//# sourceMappingURL=app.min.js.map